<!DOCTYPE html>
<meta charset=utf-8><script>
// MIT License ¬© 2025 Syluminose
let M=1,a=.063,am=a/10,Et=16,
d=document,c=z=>d.createElement(z),e=d.documentElement,s=[],E=[],SB=null,Ct='#fffd',RM_T=null,RM_I=-1,MG=1,$c=0,f5=Float32Array,C$=t=>{if(t!==$c)throw'A'},{max:ma,min:mi,sin:sn,cos:cs,random:rn,abs:ab,PI:pi,sqrt:sq,atan2:at,pow:pw}=Math,tp=pi*2,Fn=(a,b)=>sq(a/ma(.001,b))/tp,SR=44100,FC=[18700,19200,19700,19200],k$=(v,l,h)=>ma(l,mi(h,v)),go=f=>{s.length&&(f(),At())},sE=f=>{f();At()},gR=t=>t.getBoundingClientRect(),W=(t,a)=>t.textContent=a,C=(t,k)=>t.style.cssText=k,mk=(l,x,t)=>{let o=c(l);x&&W(o,x);t&&C(o,t);return o},ap=(p,...a)=>p.append(...a),ev=(l,n,f)=>l['on'+n]=f,mp=(n,f)=>{if(n?.length)for(let i=0;i<n.length;i++)f(n[i],i);else for(let i=0;i<n;i++)f(i)},tG='G√©n√©ration',EM=['‚è≥','üîî','üö©','üåÄ','üåä','üìå','üèÆ','‚≠ê','üìç','üí†','‚ö°'],BT=['üî∂','üîÅ','‚òÄÔ∏è','üé≤','ü™á','ü™©','‚ùå','+','üåì'],B='width:100%;',CU='cursor:pointer;',BR='border-radius:1vmin;',PD='padding:1vmin;',P5='padding:0.5vmin;',G1='gap:1vmin;',D='display:flex;',CEN='justify-content:center;align-items:center;',F_CEN=D+CEN,FW='font-weight:bold;',FS='font-size:',S1=FS+'2vmin;',S2=FS+'4vmin;',S3=FS+'3vmin;',S0=S3+FW,ICO=CU+S2,C1='white-space:pre;color:',I_BASE=ICO+C1,IB=I_BASE+'#000;',IR=I_BASE+'#f44;',IY=I_BASE+'#fb4;',IG=I_BASE+'#0b0;',IM=F_CEN+'min-width:8.5vmin;height:8vmin;',S4=D+'align-items:center;'+G1,R_P='position:relative;',H5='height:5vmin;',F_C='flex-direction:column;'+CEN+'text-align:center;',B_S=R_P+CU+P5+BR+C1+'#000;'+D+F_C+'background:'+Ct+';flex-shrink:0;',S5=B_S+'height:8vmin;min-width:12vmin;',S5G=B_S+'height:10vmin;min-width:12vmin;',S6='position:fixed;left:5vmin;width:90vmin;z-index:99;background:'+Ct+';'+BR+PD+'display:none;max-height:80vh;overflow-y:auto;box-shadow:0 1vh 3vh #0005;border:1px solid #000;',S9='position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:90vmin;background:#000;color:#fff;'+PD+BR+S1+'z-index:100;white-space:pre-line;border:2px solid #fb4',B_BT=BR+S3+CU+H5+R_P+'overflow:hidden;border:none;padding:1vmin 2vmin;color:#000;',PL=[-.33,0,.33],PR=[-.33,0,.33],qC=(f,t=rH)=>{t&&cancelIdleCallback(t);return requestIdleCallback(f)},hM=x=>k$(x*22,0,330),G=i=>{let M=0,b=s[i];mp(3,k=>{let o=k*22;M=ma(M,sq(b[o+3]*b[o+4]))});return`hsl(${hM(M)},100%,50%)`},hG=(f,k,i,l)=>{let M=0,s0=s[i],s1=s[i+1];mp(3,c=>{let o=c*22,A3=s0[o+3]+(s1[o+3]-s0[o+3])*f,A4=s0[o+4]+(s1[o+4]-s0[o+4])*f;M=ma(M,sq(A3*A4))});return`hsl(${hM(M)},100%,${l}%)`},H=(i,l)=>i>=s.length-1?G(i).replace('50%',`${l}%`):`linear-gradient(to bottom,${Array.from({length:9},(_,j)=>hG(j/8,0,i,l)).join(',')})`,
P=[[[0,300],[0,0],[0,0],[0,0],1,'Dur√©e (s)',0],[[0,30],[-10,10],[0,0],[0,0],.05,'Freq(Hz)',1],[[-.5,.5],[-1,1],[0,0],[0,0],.01,'Offset (Cy)',1],[[0,5],[-1,1],[0,0],[0,0],.01,'Amp PM (Cy)',1],[[0,1000],[-2,2],[0,0],[0,0],.01,'Amp CRM (Hz/s)',1],[[-.5,.5],[-1,1],[0,0],[0,0],.01,'Offset CRM (Cy)',1],[[0,1],[-1,1],[0,0],[0,0],.01,'Min AM (0-1)',1],[[0,40],[-.2,.2],[0,0],[0,0],.01,'Freq AM (Hz)',1],[[-.5,.5],[-1,1],[0,0],[0,0],.01,'Offset AM (Cy)',1],[[-1,1],[-1,1],[0,0],[0,0],.01,'Skew',1],[[0,4],[-1,1],[0,0],[0,0],.01,'Shape',1]],
P0=[10,10,12,16,0,0,2.55,10.19,4,25.1,0,0,.5,.5,.1,.5,0,0,0,0,1,1],
P1=[10,10,12,16,0,0,10.19,10.19,1,25.1,0,0,.5,.5,.1,.5,0,0,0,0,1,1],
P2=[10,10,12,16,0,0,5.1,5.1,2,50,0,0,.5,.5,.1,.5,0,0,0,0,1,1],
P3=[10,10,30,30,0,0,5,5,50,50,0,0,.5,.5,.1,.5,0,0,-1,1,1,1],
P4=[10,10,12,16,0,0,5.1,5.1,12.6,50,0,0,.5,.5,.1,.5,0,0,0,0,1,1],
PX=[P0,P1,P2,P3,P4],pI=0,
gX=(r,x,j)=>({ty:r[6],lb:r[5],st:r[4],gl:r[0],rp:[x[j*2],x[j*2+1]],gb:r[1],rcd:r[2],rb:r[3]}),gr=(rg,st)=>(st>=1)?~~(rn()*(rg[1]-rg[0]+1)+rg[0]):+(rn()*(rg[1]-rg[0])+rg[0]).toFixed(st.toString().split('.')[1]?.length||0),rV=(px=PX[pI])=>{let a_=new f5(66);mp(11,j=>{let {ty,st,rp,rcd,rb}=gX(P[j],px,j),C=gr(rp,st),R=[C+rcd[0],C+rcd[1]];if(ty){let P_=[],B_k=[];mp(3,()=>{P_.push(gr(R,st));B_k.push(gr(rb,st))});mp(6,k=>{let c=k>>1;a_[k*11+j]=(k&1)?P_[c]+B_k[c]/2:P_[c]-B_k[c]/2})}else mp(6,k=>a_[k*11+j]=C)});return a_},rS=()=>PO(rV()),cp=a=>new f5(a),FX=(sg,j)=>{let a=k=>mp(6,m=>sg[m*11+k]=sg[(2+(m&1))*11+k]);j?a(j):mp(11,k=>k>0&&a(k))},PO=sg=>{mp(3,i=>{let o=i*2;sg[o*11+5]=PL[i];sg[(o+1)*11+5]=PR[i]});return sg},sw=(a,j)=>{let f=k=>{if(gX(P[k],P0,k).ty)mp(3,c=>{let o=c*22+k,v=a[o];a[o]=a[o+11];a[o+11]=v})};j?f(j):mp(11,k=>f(k));return a},u$=(sg,j,k,v)=>{let si=k&1,pI=(k&~1)*11+j,pA=(k|1)*11+j,B=si?v:sg[pA]-sg[pI],P=si?(sg[pI]+sg[pA])/2:v;sg[pI]=P-B/2;sg[pA]=P+B/2},dL=(i,p,l1,sr)=>{let b=s[i],r=P[p],{ty,st}=gX(r,P0,p),pc=st.toString().split('.')[1]?.length||0;if(l1){let l=b[p],rv=b[11+p];if(ty==1){let h='';mp(3,x=>{h+=b[x*22+p].toFixed(pc)+' '+b[x*22+11+p].toFixed(pc)+'\n'});W(l1,h.trim());C(l1,C1+'#000;display:block;text-align:center;line-height:1.2;');sr&&C(sr,'display:none')}else{W(l1,l.toFixed(pc));sr&&(W(sr,(ty||l!=rv)?rv.toFixed(pc):''),C(sr,'display:'+((ty||l!=rv)?'block':'none')))}}},U=[],mo,sl=[],ga=[],cv,zm,if$,zo=0,zs=1,dt=[],gl,g2,pg,p2,rH=null,ZW=null,t0g=0,P$A=null,t$A=null,Tt=0,M_=(a,b,t)=>(a+b)/2*t,P$=ss=>{let A=[],hC=new f5(6),hP=new f5(6),hA=new f5(6);mp(ss,(sg,i)=>{let nv=ss[i+1];A.push({C:[...hC],P:[...hP],A:[...hA]});if(nv){let dT=sg[0];mp(6,k=>{let ch=k*11;hC[k]+=M_(Fn(sg[ch+4],sg[ch+3]),Fn(nv[ch+4],nv[ch+3]),dT);hP[k]+=M_(sg[ch+1],nv[ch+1],dT);hA[k]+=M_(sg[ch+7],nv[ch+7],dT)})}});return A},T$=ss=>{let T=0,A=[];mp(ss.length-1,i=>{let dT=ss[i][0];A.push({t:T,dT,sg:ss[i],sn$:ss[i+1],hO:P$A[i]});T+=dT});Tt=T;t$A=A},tI=(T,z)=>`t=${(zo*T).toFixed(2)}s-${((zo+zs)*T).toFixed(2)}s${z?' Zoom√ó'+(1/zs).toFixed(1):''}`,wI=()=>new Promise(r=>requestIdleCallback(r)),qR=f=>{rH=qC(()=>{f();rH=null})},Li=(a,b,t,D)=>a+(b-a)*t/D,In=(a,b,t,D)=>a*t+(b-a)*t*t/(2*D),Sl=(a,b,D)=>(b-a)/D,vA=(M,A,t)=> (1-M)*(sn(tp*A)/2+.5)+M,cV=(p,n,t,D,hC,hP,hA,fi,ch)=>{let dT=D||1,F0=Fn(p[ch+4],p[ch+3]),F1=Fn(n[ch+4],n[ch+3]),A=Li(p[ch+3],n[ch+3],t,dT),W$=Li(p[ch+4],n[ch+4],t,dT),Ag=tp*(hC+In(F0,F1,t,dT)+Li(p[ch+5],n[ch+5],t,dT)),Os=sn(Ag);if(fi==1){let iF=In(p[ch+1],n[ch+1],t,dT),lH=Li(p[ch+2],n[ch+2],t,dT),lM=Li(p[ch+6],n[ch+6],t,dT),AmAg=hA+In(p[ch+7],n[ch+7],t,dT)+Li(p[ch+8],n[ch+8],t,dT),Sk=Li(p[ch+9],n[ch+9],t,dT),Sh=Li(p[ch+10],n[ch+10],t,dT),fAg=hP+iF+lH+Li(p[ch+3],n[ch+3],t,dT)/2*Os;return vA(lM,AmAg,t)*pw((sn(tp*fAg+Sk*sn(tp*fAg))/2+.5),Sh)}return fi==2?Li(p[ch+1],n[ch+1],t,dT)+Sl(p[ch+2],n[ch+2],dT)+sq(A*W$)/2*cs(Ag):Sl(p[ch+1],n[ch+1],dT)-W$*.5*sn(Ag)},gD=async(n,T,cT,oP)=>{let dr=[],dA=[[],[],[]];for(let c=0;c<3;c++)for(let y=0;y<3;y++){C$(cT);let fi=y+1,fC=!y?FC[c]:FC[3],pC=fi==1?tp*fC/SR:0,st=[new f5(n),new f5(n)],sm=fi==1?[new f5(n),new f5(n)]:null,mn=[1e9,1e9],mx=[-1e9,-1e9],cP=[0,0],kS=c*2,i_s=0;for(let i=0;i<n;i++){let tg=i*T/n;while(i_s<t$A.length-1&&tg>=t$A[i_s+1].t)i_s++;let {t:ts,dT,sg,sn$,hO}=t$A[i_s],t=tg-ts;for(let k=0;k<2;k++){let ch=kS+k,o=ch*11,v=cV(sg,sn$,t,dT,hO.C[ch],hO.P[ch],hO.A[ch],fi,o);st[k][i]=v;if(fi==1){sm[k][i]=v*sn(cP[k]);cP[k]+=pC;if(cP[k]>=tp)cP[k]-=tp}else{mn[k]=mi(mn[k],v);mx[k]=ma(mx[k],v)}}}let g0=0,g1=1,isS=(fi==1);if(!isS){g0=mi(mn[0],mn[1]);g1=ma(mx[0],mx[1])}let ri=65535/(g1-g0||1);mp(2,k=>{let pU=new Uint16Array(n),sv=st[k];for(let i=0;i<n;i++)pU[i]=k$(~~((sv[i]-g0)*ri),0,65535);dA[y].push({p:pU,gm:[0,65535],isS,f:isS?sm[k]:null})});oP&&oP((c*3+y+1)/9,`Pr√©cision ${~~(((c*3+y+1)/9)*100)}%`);await wI()}mp(3,y=>dr.push(dA[y][0],dA[y][2],dA[y][4],dA[y][1],dA[y][3],dA[y][5]));return dr},iG=ca=>{let g=ca.getContext('webgl2',{alpha:!1,antialias:!0,preserveDrawingBuffer:!0});if(!g)return null;let s=(t,S)=>{let h=g.createShader(t);g.shaderSource(h,S);g.compileShader(h);return h},pg=g.createProgram();g.attachShader(pg,s(g.VERTEX_SHADER,'#version 300 es\nin vec2 p;void main(){gl_Position=vec4(p,0,1);}'));g.attachShader(pg,s(g.FRAGMENT_SHADER,'#version 300 es\nprecision mediump float;out vec4 fragColor;uniform vec3 c;void main(){fragColor=vec4(c,1);}'));g.linkProgram(pg);return{g,pg}},dr=(ca,os,z,T,iZ)=>{let r=gR(ca),dp=devicePixelRatio,w=r.width*dp,h=r.height*dp;ca.width=w;ca.height=h;let g=iZ?g2:gl,pg$=iZ?p2:pg;if(!g){let in$=iG(ca);g=in$.g;pg$=in$.pg;iZ?(g2=g,p2=pg$):(gl=g,pg=pg$)}g.viewport(0,0,w,h);g.clearColor(os?0:.067,os?0:.067,os?0:.067,1);g.clear(g.COLOR_BUFFER_BIT);g.useProgram(pg$);let lw=iZ?8:1,pL=g.getAttribLocation(pg$,'p'),cL=g.getUniformLocation(pg$,'c'),hS=h/18,mS=w<<1,sc2=2/h;mp(dt,(d,gi)=>{g.lineWidth(gi>=6&&gi<=17&&!iZ?4:lw);let st=~~(os*d.p.length),ed=mi(d.p.length,~~((os+z)*d.p.length)),zp=os?d.p.subarray(st,ed):d.p,dL=zp.length,pd=zp;if(dL>mS){let sp=~~(dL/mS),nL=~~(dL/sp);pd=new Uint16Array(nL);for(let i=0;i<nL;i++)pd[i]=zp[i*sp]}let rL=pd.length<<1;if(!SB||SB.length<rL)SB=new f5(rL);let vt=SB.subarray(0,rL),pL$=pd.length-1||1,scY=d.isS?hS:hS/(d.gm[1]-d.gm[0]||1),ofY=1-gi*hS/h*2;for(let i=0;i<pd.length;i++){vt[i<<1]=i/pL$*2-1;vt[(i<<1)+1]=d.isS?(ofY-hS*sc2)+(pd[i]/65535)*scY*sc2:ofY-(d.gm[1]-(d.gm[0]+(pd[i]/65535)*(d.gm[1]-d.gm[0])))*scY*sc2}let bf=d.buffer;if(!bf||d.vL!==rL){bf&&g.deleteBuffer(bf);bf=g.createBuffer();d.buffer=bf}g.bindBuffer(g.ARRAY_BUFFER,bf);g.bufferData(g.ARRAY_BUFFER,vt,g.DYNAMIC_DRAW);d.vL=rL;g.enableVertexAttribArray(pL);g.vertexAttribPointer(pL,2,g.FLOAT,!1,0,0);g.uniform3fv(cL,[[1,.27,.27],[.27,1,.27],[.27,.27,1]][gi%3]);g.drawArrays(g.LINE_STRIP,0,pd.length)})},J=async()=>{let Tt_=Tt;$c++;const t_=$c;if(!mo){let s_=`position:absolute;top:0;right:0.5vmin;color:#fb4;${S1}pointer-events:none;z-index:1`,z_=`position:fixed;top:0;left:0;width:100vw;height:calc(100dvh - 25vh - 12vmin);background:#000;color:#fff;${BR+S1}z-index:9;${D}flex-direction:column;align-items:center;border-bottom:2px solid #fb4`;mo=mk('div','','position:relative;width:100%;height:25vh;background:#000;color:#fff;border-top:2px solid #fff;');cv=mk('canvas','','border:1px solid #fb4;'+B+'height:100%;display:block;');zm=mk('canvas','',B+'height:100%;display:block;min-height:0;background:#000');if$=mk('div',tI(Tt_),`top:0.2vmin;${s_}`);let ct=mk('div','',B+'height:100%;position:relative;min-height:0');ap(ct,if$,cv);ap(mo,ct);ev(cv,'click',()=>{if(ZW)return;let T=Tt_,zM=mk('div','',z_),zW=mk('div','',B+'height:100%;position:relative;min-height:0;');ZW=zM;let cl=mk('div','‚ùå',`position:absolute;top:0.5vmin;right:0.5vmin;${IR}z-index:2`);ev(cl,'click',()=>{(ZW.remove(),ZW=null)});let zI=mk('div',tI(T,1),`top:2vmin;right:5vmin;${s_.replace('z-index:1','z-index:2')}`);ap(zW,zm,zI,cl);ap(zM,zW);ap(U[0],zM);dr(zm,zo,zs,T,!0);let uM=e=>{let rt=gR((e.touches?.[0]??e).target),x=((e.touches?.[0]??e).clientX-rt.left)/rt.width,T=Tt_;zo=k$(x-zs/2,0,1-zs);dr(zm,zo,zs,T,!0);W(zI,tI(T,1))},hW=e=>{e.preventDefault();let nz=k$(zs*(1+e.deltaY*-.001),.01,1),T=Tt_;zo=k$(zo+(zs-nz)/2,0,1-nz);zs=nz;dr(zm,zo,zs,T,!0);W(zI,tI(T,1))};ev(zm,'mousemove',uM);ev(zm,'touchmove',uM);ev(zm,'wheel',hW)})};zs=1/Tt_;zo=0;t0g=performance.now();try{dt=await gD(~~(Tt_*300),Tt_,t_,(p,m)=>W(if$,`‚è≥ ${m}`));queueMicrotask(()=>{dr(cv,0,1,Tt_);dr(zm,zo,zs,Tt_,!0);W(if$,tI(Tt_)+` (${(performance.now()-t0g).toFixed(2)}ms)`)});}catch(e){if(e==='A')W(if$,'‚ùå Annul√©')}},cS$=(r,j,k,v,m,uFx,mc)=>{let sp=gX(r,PX[pI],j),{gl,gb,st}=sp,ib=m==1&&k%2,mn=(ib?gb:gl)[0],mx=(ib?gb:gl)[1],prec=(st.toString().split('.')[1]?.length||0),lb=()=>mc?`üü°${m?['P','B'][k&1]:['G','D'][k&1]} ${v.toFixed(prec)}`:j==0?`${EM[j]} ${v.toFixed(prec)}`:j?`${['üî¥','üü¢','üîµ'][k>>1]}${m?['P','B'][k&1]:['G','D'][k&1]} ${v.toFixed(prec)}`:`${EM[j]} ${v.toFixed(prec)}`,lT=mk('div',lb(),S0+'text-align:center;min-width:15vmin;flex-shrink:0;'),cl=mc?'#fb4':j==0?'#fb4':['#f00','#0b0','#00f'][k>>1],sl=c('input');sl.type='range';sl.min=mn;sl.max=mx;sl.step=st;sl.value=v;C(sl,`flex-grow:1;margin:0 1vmin;height:1vmin;appearance:none;background:${cl};${BR}--c:${cl}`);let uV=(nv,fin)=>{v=k$(+nv.toFixed(prec),mn,mx);sl.value=v;W(lT,lb());uFx(v,fin)};ev(sl,'input',()=>uV(+sl.value,0));ev(sl,'change',()=>uV(+sl.value,1));let aC=mk('div','',D+'align-items:center;width:100%;'),bL=mk('div','',D+'min-width:8vmin;flex-shrink:0;'),bR=mk('div','',D+'min-width:8vmin;flex-shrink:0;');mp(4,u=>{let stp=[[-10,-1],[1,10]][u/2|0][u%2],t=['‚´∑','‚™°','‚™¢','‚´∏'][u],b=mk('div',t,S0+CU+'width:4vmin;text-align:center;');ev(b,'click',e=>{e.stopPropagation();uV(v+stp*st,1)});u<2?ap(bL,b):ap(bR,b)});ap(aC,bL,lT,sl,bR);return{container:aC,uV}},z=()=>W(U[5],`Configuration-${s.length-1} s√©quences-${Tt.toFixed(2)}s`),uL=(i,p,l1,fin)=>{if(l1){dL(i,p,l1,l1.nextElementSibling)}uc();if(fin){P$A=P$(s);T$(s);z();qR(()=>mo&&J())}},hS=e=>{mp(ga,sd=>sd&&(sd.style.display='none'));mp(sl,row=>mp(row,sd=>sd&&(sd.style.display='none')));mp(E,it=>{it[1].style.display='none';it[2].style.display='none'})},mBA=(isG,i,j,r,sd,rF)=>{if(j<1)return;let tB=mk('div','',D+'justify-content:space-between;align-items:center;padding-bottom:1vmin;'),bL=mk('div','',S4),bM=mk('div',BT[8],ICO),tx=mk('div',MG?'P/B':'G/D',S1+IB+FW);ev(bM,'click',e=>{e.stopPropagation();MG=1-MG;rF()});ap(bL,bM,tx);let bR=mk('div','',D+G1);mp(5,bI=>{let b=mk('div',BT[bI],ICO);ev(b,'click',e=>{e.stopPropagation();go(()=>{let a=k=>{let {ty,st,rp,rcd,rb}=gX(r,PX[pI],j);if(bI==0)mp(6,m=>s[k][m*11+j]=s[0][m*11+j]);if(bI==1){if(isG){if(k%2)sw(s[k],j)}else sw(s[k],j)}if(bI==2){mp(2,m=>{let o=m?44:0;s[k][o+j]=s[k][22+j];s[k][o+11+j]=s[k][33+j]})}if(bI==3){let C=gr(rp,st),R=[C+rcd[0],C+rcd[1]];if(ty){let P_=[],B_k=[];mp(3,()=>{P_.push(gr(R,st));B_k.push(gr(rb,st))});mp(6,m=>{let c=m>>1;s[k][m*11+j]=(m&1)?P_[c]+B_k[c]/2:P_[c]-B_k[c]/2})}else mp(6,m=>s[k][m*11+j]=C)}if(bI==4)mp(3,p_=>u$(s[k],j,p_*2+1,0))};mp(s,(v,k)=>((isG||k==i)&&a(k)))});rF()});ap(bR,b)});ap(tB,bL,bR);sd.prepend(tB)},iC=(r,j,vs,vs2,sd,i)=>{let rF=()=>{W(sd,'');let d_=`flex-direction:column;flex:1;${G1}`,ct1=mk('div','',D+d_),uF=(v,fin)=>{mp(s,k=>mp(6,m=>k[m*11+j]=v));if(fin){At();qR(()=>mo&&J())}};if(!j){ap(ct1,cS$(r,j,0,vs[0],0,uF).container);ap(sd,ct1)}else{let dG=mk('div','',D+'gap:2vmin;'),cts=[mk('div','',D+d_),mk('div','',D+d_)],sL_=[],sP_=[];let uFg=k=>(v,fin)=>{let {ty}=gX(r,PX[pI],j);mp(s,row=>{if(ty===1)row[k*11+j]=v;else mp(6,m=>row[m*11+j]=v)});if(fin){At();qR(()=>mo&&J())}},uFp=k=>(v,fin)=>{mp(s,row=>u$(row,j,k,v));if(fin){At();qR(()=>mo&&J())}};mp(vs,(v,k)=>{let{container:ct,uV}=cS$(r,j,k,v,0,uFg(k));sL_.push(uV);ap(cts[0],ct)});mp(vs2,(v,k)=>{let{container:ct,uV}=cS$(r,j,k,v,1,uFp(k));sP_.push(uV);ap(cts[1],ct)});let mG=idx=>{let v_=(vs[idx]+vs[idx+2]+vs[idx+4])/3;cts[0].prepend(cS$(r,j,idx,v_,0,(v,f)=>mp(3,o=>sL_[idx+o*2](v,f)),1).container)},mP=idx=>{let v_=(vs2[idx]+vs2[idx+2]+vs2[idx+4])/3;cts[1].prepend(cS$(r,j,idx,v_,1,(v,f)=>mp(3,o=>sP_[idx+o*2](v,f)),1).container)};mp(2,x=>{mG(1-x);mP(1-x)});ap(dG,MG?cts[1]:cts[0]);ap(sd,dG)}mBA(!0,i,j,r,sd,rF)};rF();return()=>sd.style.display='none'},iS=(r,j,b,i,l1,sr,sd)=>{let rF=()=>{W(sd,'');let d_=`flex-direction:column;flex:1;${G1}`;if(!j){let v=b[j],ct1=mk('div','',D+d_),uFx=(v,fin)=>{mp(6,k=>s[i][k*11+j]=v);uL(i,j,l1,fin)};ap(ct1,cS$(r,j,0,v,0,uFx).container);ap(sd,ct1)}else{let {ty}=gX(r,PX[pI],j),iv=ty===1?[s[i][j],s[i][11+j],s[i][22+j],s[i][33+j],s[i][44+j],s[i][55+j]]:[s[i][j],s[i][11+j]],iv2=[];mp(3,k=>iv2.push((s[i][(k*2)*11+j]+s[i][(k*2+1)*11+j])/2,s[i][(k*2+1)*11+j]-s[i][(k*2)*11+j]));let uFg=k=>(v,fin)=>{if(ty===1)s[i][k*11+j]=v;else mp(6,m=>s[i][m*11+j]=v);uL(i,j,l1,fin)},uFp=k=>(v,fin)=>{u$(s[i],j,k,v);uL(i,j,l1,fin)},dG=mk('div','',D+'gap:2vmin;'),cts=[mk('div','',D+d_),mk('div','',D+d_)],sL_=[],sP_=[];mp(iv,(v,k)=>{let{container:ct,uV}=cS$(r,j,k,v,0,uFg(k));sL_.push(uV);ap(cts[0],ct)});mp(iv2,(v,k)=>{let{container:ct,uV}=cS$(r,j,k,v,1,uFp(k));sP_.push(uV);ap(cts[1],ct)});let mG=idx=>{let v_=(iv[idx]+iv[idx+2]+iv[idx+4])/3;cts[0].prepend(cS$(r,j,idx,v_,0,(v,f)=>mp(3,o=>sL_[idx+o*2](v,f)),1).container)},mP=idx=>{let v_=(iv2[idx]+iv2[idx+2]+iv2[idx+4])/3;cts[1].prepend(cS$(r,j,idx,v_,1,(v,f)=>mp(3,o=>sP_[idx+o*2](v,f)),1).container)};mp(2,x=>{mG(1-x);mP(1-x)});ap(dG,MG?cts[1]:cts[0]);ap(sd,dG)}mBA(!1,i,j,r,sd,rF)};rF();return()=>sd.style.display='none'},gT=(r,j)=>{let {lb,ty}=gX(r,PX[pI],j),hL=lb,m=hL.match(/(.*)(\(.*\))$/);if(m){let lB=m[1],uN=m[2];if(j>=3&&j<=5){let pS=[];if(~lB.indexOf('Osc')){pS.push('Osc');pS.push(lB.replace('Osc',''))}else pS.push(lB);hL=pS.filter(p=>p.length).join('\n')+'\n'+uN}else hL=lB+'\n'+uN}else hL=lb+'\n'+(ty?ty==1?'(Hz)':'(tours)':'(sec)');return{hL,em:EM[j]}},gP=(p,r,j,i,b,isG)=>{let w=mk('div','',isG?S5G:S5),l1=c('div'),sr=c('div'),sd=mk('div','',S6);isG?ga[j]=sd:sl[i][j]=sd;if(isG){let {hL,em}=gT(r,j),l3=mk('div',em,S2),v1=mk('div','',S1+C1+'#000;');W(v1,hL);ap(w,l3,v1,sd)}else{C(l1,S1+C1+'#000');C(sr,S1+C1+'#000');dL(i,j,l1,sr);ap(w,l1,sr,sd)}ev(w,'click',e=>{e.stopPropagation();hS();let vs=j?[s[0][j],s[0][11+j],s[0][22+j],s[0][33+j],s[0][44+j],s[0][55+j]]:[s[0][j]],vs2=[];mp(3,k=>vs2.push((s[0][(k*2)*11+j]+s[0][(k*2+1)*11+j])/2,s[0][(k*2+1)*11+j]-s[0][(k*2)*11+j]));(isG?iC(r,j,vs,vs2,sd):iS(r,j,b,i,l1,sr,sd));sd.style.top=k$(gR(w).bottom+5,50,window.innerHeight-200)+'px';sd.style.display='block'});ap(p,w);return w},K=()=>{let k_=`position:sticky;top:0;left:0;right:0;z-index:1;background:linear-gradient(45deg,#ff0,#f0f,#0ff,#0f0);${PD+S1}`,h=mk('div','',D+'justify-content:space-between;align-items:center;'),ht=mk('div','üåàSpiraStrober',C1+'#000;'+S2+'cursor:default;'),hb=mk('div','',D+G1);bP=mk('div','üéØ P'+pI,IB);ev(bP,'click',()=>W(bP,'üéØ P'+(pI=(pI+1)%5)));ap(hb,bP,mk('div',' ',S1));mp(6,i=>{let b=mk('div',BT[i],IB);ev(b,'click',()=>go(()=>{if(i==0)mp(s.length-1,k=>s[k+1]=cp(s[0]));if(i==1)mp(s,(v,k)=>k&1&&(s[k]=sw(v)));if(i==2)mp(s,row=>mp(11,j=>j&&mp(2,m=>{let o=m?44:0;row[o+j]=row[22+j];row[o+11+j]=row[33+j]})));if(i==3)mp(s,(v,k)=>s[k]=rV());if(i==4)mp(s,row=>mp(11,j=>j&&mp(3,o=>u$(row,j,o*2+1,0))));if(i==5)mp(s,(v,k)=>PO(v))}));ap(hb,b)});ap(h,ht,hb);let p=mk('div','',S4);mp(11,j=>gP(p,P[j],j,null,null,!0));let wM=mk('div','',S5G+D+'flex-direction:row;gap:0.5vmin;'),bD=mk('div','üîª',ICO),bu=mk('div','üî∫',ICO),br=mk('div','‚ôªÔ∏è',ICO);ev(bD,'click',()=>go(()=>s.push(rS())));ev(bu,'click',()=>go(()=>s.unshift(rS())));ev(br,'click',()=>go(()=>{s=[rS()];At()}));ap(wM,bD,bu,br);ap(p,wM);let g=mk('div','',k_);ap(g,h,p);return g},L=i=>{let a_=c('div'),b=s[i],sL=s.length,sW='position:absolute;top:0;right:0;width:28vmin;background:'+Ct+';'+BR+'z-index:2;'+D+'flex-wrap:wrap;align-items:center;justify-content:around;padding:1vmin;gap:1vmin;display:none;';C(a_,`border:0;border-radius:0;background:${H(i,50)};${P5}position:relative;${S1}`+D+'align-items:center;justify-content:space-between;gap:0.5vmin;');let pd=mk('div','',D+'align-items:center;'+G1+'flex-grow:1;min-width:0;');sl[i]=[];mp(11,j=>gP(pd,P[j],j,i,b,!1));let ms=[mk('div','',sW),mk('div','',sW)],ac=[{style:IG,target:ms[0],actions:[()=>sE(()=>s.splice(i+1,0,cp(s[i]))),()=>sE(()=>s.splice(i+1,0,sw(cp(s[i])))),()=>sE(()=>sE(()=>{let a_=rV();FX(a_);s.splice(i+1,0,a_)})),()=>sE(()=>s.splice(i+1,0,rV())),()=>sE(()=>sE(()=>{let a_=rV();mp(11,j=>j&&mp(3,o=>u$(a_,j,o*2+1,0)));s.splice(i+1,0,a_)})),()=>sE(()=>s.splice(i+1,0,rS()))]},{style:IY,target:ms[1],actions:[()=>i&&sE(()=>s[i]=cp(s[i-1])),()=>sE(()=>s[i]=sw(cp(s[i]))),()=>sE(()=>FX(s[i])),()=>sE(()=>s[i]=rV()),()=>sE(()=>mp(11,j=>j&&mp(3,o=>u$(s[i],j,o*2+1,0)))),()=>sE(()=>PO(s[i]))]}];mp(2,idx=>{let {style:st,target:tg,actions:f}=ac[idx];mp(6,k=>{let b=mk('div',BT[k],st+IM);ev(b,'click',e=>{e.stopPropagation();f[k]()});ap(tg,b)})});let wA=mk('div','',S5+D+'flex-direction:row;gap:0.5vmin;flex-shrink:0;'),bD=mk('div',BT[6],IR),bM=mk('div','üìù',IR),bA$=mk('div','‚ú¥Ô∏è',IY);C(bD,`opacity:${sL<=1?.3:1};${bD.style.cssText}`);ev(bD,'click',()=>sL>1&&sE(()=>s.splice(i,1)));ev(bM,'click',e=>{e.stopPropagation();hS();ms[1].style.display='flex'});ev(bA$,'click',e=>{e.stopPropagation();hS();ms[0].style.display='flex'});ap(wA,bM,bA$,bD);ap(pd,wA);ap(a_,pd,...ms);return[a_,ms[0],ms[1]]},uc=()=>mp(E,(it,i)=>{if(it&&it[0])it[0].style.background=H(i,50)}),At=()=>{let f=d.createDocumentFragment(),cL=s.length;while(E.length>cL){let r=E.pop();r&&r[0].remove()}mp(s,(row,i)=>{if(!E[i]){let b=L(i);E[i]=b;ap(f,b[0])}else{let pd=E[i][0].firstChild;E[i][0].style.background=H(i,50);mp(11,j=>dL(i,j,pd.childNodes[j].firstChild,pd.childNodes[j].childNodes[1]))}});if(f.childNodes.length)ap(U[4],f);P$A=P$(s);T$(s);z();J()},uP=(p,mg)=>{eBg.style.width=(p*100)+'%';W(eBt,mg?`‚è≥ ${~~(p*100)}% - ${mg}`:tG)},eA=async P$0=>{let t=Tt;$c++;let T=$c;if(t<=0||s.length<=1)throw new Error('dur√©e nulle');let f=~~(t*SR),c=sC,u=c<3?a:a/3,O=44,h=0,H=0,p=tp*18200/SR,m=tp*20/SR,S=32768,C_=(f+S-1)>>15,W$=44+f*4,A=new ArrayBuffer(W$),V=new DataView(A),pC=[0,0,0,0,0,0,0],fC$=c===3?[FC[0],FC[1],FC[2]]:[FC[3],FC[3],FC[3]],pI=fC$.map(f=>tp*f/SR);mp('RIFFWAVEfmt ',(v,i)=>V.setUint8(i<4?i:i+4,v.charCodeAt(0)));V.setUint32(4,W$-8,1);V.setUint32(16,16,1);V.setUint16(20,1,1);V.setUint16(22,2,1);V.setUint32(24,SR,1);V.setUint32(28,SR*4,1);V.setUint16(32,4,1);V.setUint16(34,16,1);mp('data',(v,i)=>V.setUint8(36+i,v.charCodeAt(0)));V.setUint32(40,f*4,1);for(let k=0;k<C_;k++){let s_=k*S,l=mi((k+1)*S,f)-s_,i_s=0;for(let j=0;j<l;j++){let ix=s_+j,tg=ix/SR;while(i_s<t$A.length-1&&tg>=t$A[i_s+1].t)i_s++;let {t:ts,dT,sg,sn$,hO}=t$A[i_s],t=tg-ts,vL=0,vR=0;for(let i=0;i<3;i++){if(c>=3||c===i){let chL=i*2,chR=chL+1,v=cV(sg,sn$,t,dT,hO.C[chL],hO.P[chL],hO.A[chL],1,chL*11)*sn(pC[chL]);vL+=v;pC[chL]+=pI[i];if(pC[chL]>=tp)pC[chL]-=tp;let v2=cV(sg,sn$,t,dT,hO.C[chR],hO.P[chR],hO.A[chR],1,chR*11)*sn(pC[chR]);vR+=v2;pC[chR]+=pI[i];if(pC[chR]>=tp)pC[chR]-=tp}}if(c===3){let Q=sn(h),Z=sn(H),Qh=Q*am;V.setInt16(O,k$((vL*a+Qh*(1-Z))*32767,-32768,32767)|0,1);O+=2;V.setInt16(O,k$((vR*a+Qh*(1+Z))*32767,-32768,32767)|0,1);O+=2;h+=p;if(h>=tp)h-=tp;H+=m;if(H>=tp)H-=tp}else{V.setInt16(O,k$(vL*u*32767,-32768,32767)|0,1);O+=2;V.setInt16(O,k$(vR*u*32767,-32768,32767)|0,1);O+=2}}if(!(k&7)){C$(T);P$0((k+1)/C_,`G√©n√©ration: ${~~((k+1)/C_*100)}%`);await wI()}}aP.src=URL.createObjectURL(new Blob([A],{type:'audio/wav'}))},dA=async(aF,P$0)=>{$c++;let T=$c,aC=new AudioContext({sampleRate:SR}),aB=await aC.decodeAudioData(aF),L=aB.getChannelData(0),R=aB.getChannelData(1),nS=aB.length,dR=aB.duration,nP=~~(dR*300),dS=nS/nP,N=441*M;dt=[];mp(18,()=>dt.push({p:new Uint16Array(nP),gm:[0,65535],isS:!1}));let bF=[18700,19200,19700],cO=bF.map(f=>2*cs(tp*f/SR)),cLs=['üî¥','üü¢','üîµ'];for(let c=0;c<3;c++){let w=cO[c];for(let i=0;i<nP;i++){let oW=~~(i*dS),eW=mi(nS,oW+N),qL0=0,qL1=0,qL2=0,qR0=0,qR1=0,qR2=0;for(let j=oW;j<eW;j++){qL0=L[j]+w*qL1-qL2;qL2=qL1;qL1=qL0;qR0=R[j]+w*qR1-qR2;qR2=qR1;qR1=qR0}dt[c].p[i]=k$(sq(qL1*qL1+qL2*qL2-qL1*qL2*w)/(N*a/2)*65535,0,65535);dt[c+3].p[i]=k$(sq(qR1*qR1+qR2*qR2-qR1*qR2*w)/(N*a/2)*65535,0,65535)}P$0((c+1)/3,`${cLs[c]} Analyse freq`);C$(T);await wI()}Tt=dR;P$0(1,'‚úÖ OK');queueMicrotask(()=>{dr(cv,0,1,Tt);dr(zm,zo,zs,Tt,!0)})},sC=3,aP,fC,eB,eBg,eBt;mp(6,i=>U[i]=c('div'));C(U[0],'padding:0;margin:0;overflow-x:hidden;overflow-y:auto;height:100dvh;display:block;');let tC=mk('div','','overflow-x:auto;width:100%;'),tW=mk('div','','min-width:fit-content;display:flex;flex-direction:column;');ap(tW,K(),U[4]);ap(tC,tW);ap(U[0],tC,U[5]);ap(e,U[0]);mp(Et,()=>s.push(rS()));At();ev(window,'load',()=>{d.head.innerHTML='<style>input[type=range]::-webkit-slider-thumb{appearance:none;width:3vmin;height:3vmin;background:var(--c);border-radius:50%;cursor:pointer;border:none}</style>';fC=mk('div','','position:sticky;bottom:0;left:0;right:0;z-index:1;width:100%;');let eU=mk('div','','position:relative;width:100%;padding:0.5vmin 1vmin;min-height:12vmin;background:#111;'+D+'flex-direction:column;'+G1+'border-top:1px solid #f83;'),eR=mk('div','',S4);ap(fC,mo);let opts=['üî¥','üü¢','üîµ','üåà','‚òÄÔ∏è'],nm=['Rouge','Vert','Bleu','Spectra','Unifi√©'],sP=(tx,ps)=>{let tp$=mk('div',tx,S9),cl=mk('div','‚ùå','position:absolute;top:1vmin;right:1vmin;'+IR);ev(cl,'click',()=>tp$.remove());ps&&ap(tp$,...ps);ap(tp$,cl);ap(U[0],tp$);setTimeout(()=>d.addEventListener('click',()=>tp$.parentNode&&tp$.remove(),{once:!0}),500)},tF=[mk('div',"I(X‚Çô)=X‚Çô‚ãÖt+(X‚Çô‚Çä‚ÇÅ-X‚Çô)t¬≤/(2‚è≥‚Çô)\nT(X‚Çô)=X‚Çô+(X‚Çô‚Çä‚ÇÅ-X‚Çô)t/‚è≥‚Çô\nD(X‚Çô)=(X‚Çô‚Çä‚ÇÅ-X‚Çô)/‚è≥‚Çô",C1+'#f40;'+S0),mk('div',"F‚Çô=‚àö(üåä‚Çô/üåÄ‚Çô)/2œÄ\nO‚Çô=I(F‚Çô)+T(üìå‚Çô)+O‚ÇÄ,‚Çô\na‚Çô=I(‚≠ê‚Çô)+T(üìç‚Çô)+a‚ÇÄ,‚Çô",C1+'#f90;'+S0),mk('div',"O‚ÇÄ,‚Çô=‚è≥‚Çô‚Çã‚ÇÅ(F‚Çô+F‚Çô‚Çã‚ÇÅ)/2+O‚ÇÄ,‚Çô‚Çã‚ÇÅ\na‚ÇÄ,‚Çô=‚è≥‚Çô‚Çã‚ÇÅ(‚≠ê‚Çô+‚≠ê‚Çô‚Çã‚ÇÅ)/2+a‚ÇÄ,‚Çô‚Çã‚ÇÅ\nœÜ‚ÇÄ,‚Çô=‚è≥‚Çô‚Çã‚ÇÅ(üîî‚Çô+üîî‚Çô‚Çã‚ÇÅ)/2+œÜ‚ÇÄ,‚Çô‚Çã‚ÇÅ",C1+'#9f0;'+S0),mk('div',"A‚Çô=(1-T(üèÆ‚Çô))‚ãÖ(sin(2œÄ+a‚Çô)/2+¬Ω)+T(üèÆ‚Çô)\nS‚Çô=A‚Çô.(sin(2œÄ‚ãÖœÜ‚Çô+T(üí†‚Çô)sin(2œÄ‚ãÖœÜ‚Çô))/2+¬Ω)^T(‚ö°‚Çô)",C1+'#f04;'+S0),mk('div',"œÜ‚Çô=I(üîî‚Çô)+T(üö©‚Çô)+œÜ‚ÇÄ,‚Çô+T(üåÄ‚Çô)/2‚ãÖsin(2œÄ‚ãÖO‚Çô)\nf‚Çô=T(üîî‚Çô)+D(üö©‚Çô)+‚àö(T(üåä‚Çô).T(üåÄ‚Çô))/2‚ãÖcos(2œÄ‚ãÖO‚Çô)\nk‚Çô=D(üîî‚Çô)-T(üåä‚Çô)/2‚ãÖsin(2œÄ+O‚Çô)",C1+'#f09;'+S0)];eB=mk('button','',B_BT+'background:#4af;flex:1;min-width:30vw;'),eBg=mk('div','','position:absolute;left:0;top:0;height:100%;width:0%;background:linear-gradient(90deg,#0f0,#4f4);transition:width 0.3s;'),eBt=mk('span',tG,'position:relative;z-index:1;color:black;');ap(eB,eBg,eBt);let bF=mk('div','‚õ∂',IR+B.replace('100%','7vw')+F_CEN+H5),bL=mk('div','üí°',IB+B.replace('100%','7vw')+F_CEN+H5),bW=mk('div','',R_P+B.replace('100%','7vw')+F_CEN+H5),bV=mk('div',opts[sC],IB),nS=mk('select','','position:absolute;top:0;left:0;opacity:0;'+B+H5+CU);mp(opts,(v,i)=>{let o=mk('option',v+' '+nm[i]);o.value=i;if(i===sC)o.selected=1;ap(nS,o)});ev(nS,'change',e=>{sC=+e.target.value;W(bV,opts[sC])});ap(bW,bV,nS);ev(bF,'click',()=>d.fullscreenElement?d.exitFullscreen():e.requestFullscreen());ev(bL,'click',e=>{e.stopPropagation();sP('',tF)});aP=mk('audio','',B+'height:5vmin;');aP.controls=1;ev(eB,'click',async()=>{eB.disabled=1;try{await eA(uP);setTimeout(()=>{W(eBt,tG);eBg.style.width='0%';eB.disabled=0},2e3)}catch(er){W(eBt,'‚èπÔ∏è '+er.message);eB.disabled=0}});let fI=mk('input','',H5+'display:none;');fI.type='file';fI.accept='audio/*';ev(fI,'change',async e=>{let f=e.target.files[0];if(!f)return;eB.disabled=1;try{let aB=await f.arrayBuffer();await dA(aB,uP);setTimeout(()=>{W(eBt,tG);eBg.style.width='0%';eB.disabled=0},2e3)}catch(er){W(eBt,'‚èπÔ∏è '+er.message);eB.disabled=0}finally{fI.value=''}});let bSt=mk('div','‚èπÔ∏è',ICO+F_CEN+H5+'width:8vw;');ev(bSt,'click',()=>{ $c++;W(eBt,'‚èπÔ∏è Annul√©');eBg.style.width='0%';eB.disabled=0;setTimeout(()=>W(eBt,tG),2e3)});let bSe=mk('div','üîç',ICO+F_CEN+H5+'width:8vw;');ev(bSe,'click',()=>fI.click());ap(eR,bF,bL,bW,eB,bSt,bSe);ap(eU,eR,aP,fI);ap(fC,mo,eU);ap(U[0],fC);ev(U[0],'click',hS);At()});
</script>
