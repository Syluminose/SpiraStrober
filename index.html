<!DOCTYPE html><meta charset="utf-8"><script>
// MIT License ¬© 2025 Syluminose
let d=document,c=z=>d.createElement(z),e=d.documentElement,s=[],E=[],pb=[],GB=[],SB=null,Ct='#fffd',RM_T=null,RM_I=-1,$cancelToken=0,C$=cT=>{if(cT!==$cancelToken)throw'A'},{max:ma,min:mi,sin:sn,cos:cs,random:rn,abs:ab,PI:pi}=Math,tp=pi*2,SR=44100,FC=[18700,19200,19700,19200],
go=f=>{s.length&&(f(),At())},sE=f=>{f();At()},gR=t=>t.getBoundingClientRect(),W=(t,a)=>t.textContent=a,C=(t,k)=>t.style.cssText=k,mk=(l,x,t)=>{let o=c(l);x&&W(o,x);t&&C(o,t);return o},ap=(p,...a)=>p.append(...a),ev=(l,n,f)=>l['on'+n]=f,
EM=['‚è≥','üîî','üö©','üåÄ','üí´','üìå','üèÆ','‚≠ê','üìç'],BT=['üî∂','üîÅ','‚òÄÔ∏è','üé≤','ü™á','ü™©','‚ùå','+'],
BASES='width:100%;',
C1='white-space:pre;color:',BR='border-radius:1vmin;',CU='cursor:pointer;',FS='font-size:',PD='padding:1vmin;',P5='padding:0.5vmin;',G1='gap:1vmin;',S1=FS+'2vmin;',FW='font-weight:bold;',S2=FS+'4vmin;',S0=FS+'3vmin;'+FW,D='display:flex;',DCEN='justify-content:center;align-items:center;',
ICO=CU+S2,IB=ICO+C1+'#000;',IR=ICO+C1+'#f44;',IY=ICO+C1+'#fb4;',IG=ICO+C1+'#4f4;',IM=D+DCEN+'min-width:8.5vmin;height:8vmin;',S3=D+'justify-content:center;'+G1+PD,
S4=D+'align-items:center;'+G1,
S5B='position:relative;'+CU+P5+BR+C1+'#000;'+D+'flex-direction:column;align-items:center;justify-content:center;text-align:center;background:'+Ct+';flex-shrink:0;',
S5=S5B+'height:8vmin;',S5G=S5B+'height:12vmin;',S6='position:fixed;left:5vmin;'+BASES.replace('100%','90vmin')+'z-index:1000;background:'+Ct+';'+BR+PD+'display:none;max-height:80vh;overflow-y:auto;',S9='position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);'+BASES.replace('100%','90vmin')+'background:#000;color:#fff;'+PD+BR+S1+'z-index:1001;white-space:pre-line;border:2px solid #fb4',
FP={p:[[EM[0],[0,300],[60,60],1,'Duree(s)',0],
[EM[1],[0,40],[9,11],[-10,10],[-1,1],.1,'Freq(Hz)',1],
[EM[2],[-.5,.5],[0,0],[-1,1],[0,0],.01,'Phase(cycle)',1],
[EM[3],[0,2],[0,.5],[-5,5],[0,0],.01,'OscAmp(cycle)',1],
[EM[4],[0,40],[0.1,1],[-10,10],[-.1,.1],.01,'OscFreq(Hz)',1],
[EM[5],[-.5,.5],[0,0],[-1,1],[0,0],.01,'PhaseOsc(cycle)',1],
[EM[6],[0,1],[.5,1],[-1,1],[0,0],.01,'Min Amp (C)',1],
[EM[7],[0,40],[.1,1],[-10,10],[-.1,.1],.01,'Freq AM (Hz)',1],
[EM[8],[-.5,.5],[0,0],[-1,1],[0,0],.01,'Phase AM (cycle)',1]]},
PL=[-.33,0,.33],PR=[-.33,0,.33],MD=0,hM=(x,y)=>ma(0,mi(270,ab(x-y)*9)),G=i=>`hsl(${hM(s[i][0][1],s[i][1][1])},100%,50%)`,hG=(f,k,i,l)=>{let [s0,s1,s2,s3]=[s[i][k][1],s[i+1][k][1],s[i][k+1][1],s[i+1][k+1][1]];return`hsl(${hM(s0+(s1-s0)*f,s2+(s3-s2)*f)},100%,${l}%)`},H=(i,l)=>i>=s.length-1?`hsl(${hM(s[i][0][1],s[i][1][1])},100%,${l}%)`:`linear-gradient(to bottom,${Array.from({length:9},(_,j)=>hG(j/8,0,i,l)).join(',')})`,
IX=r=>{let l=r.length;return{ty:r[l-1],lb:r[l-2],st:r[l-3],gl:r[1],rp:r[2],gb:l>6?r[3]:r[1],rb:l>6?r[4]:r[2]}},
gr=(rg,st)=>(st>=1)?~~(rn()*(rg[1]-rg[0]+1))+rg[0]:+(rn()*(rg[1]-rg[0])+rg[0]).toFixed(st.toString().split('.')[1]?.length||0),
rv=()=>FP.p.reduce((a,p)=>{let {ty,st,rp,rb}=IX(p),v=[];if(ty===0){let g=gr(rp,st);v=[g,g,g,g,g,g]}else for(let k=0;k<3;k++){let P=gr(rp,st),B=gr(rb,st);v.push(P-B/2,P+B/2)}v.forEach((x,i)=>a[i].push(x));return a},Array.from({length:6},()=>[])),
rvS=()=>{let a=rv();[0,2,4].forEach((i,k)=>a[i][5]=PL[k]);[1,3,5].forEach((i,k)=>a[i][5]=PR[k]);return a},cp=a=>structuredClone(a),
FX=sg=>{let fg=sg[2][1],fd=sg[3][1];[0,4].forEach(i=>sg[i][1]=fg);[1,5].forEach(i=>sg[i][1]=fd)},
UN=sg=>[0,2,4].forEach(k=>sg[k+1][1]=sg[k][1]),
PO=sg=>([0,2,4].forEach((ix,k)=>sg[ix][5]=PL[k]),[1,3,5].forEach((ix,k)=>sg[ix][5]=PR[k])),
sw=a=>{FP.p.forEach((r,k)=>{let {ty}=IX(r);if(ty&&k)[0,2,4].forEach(b=>{[a[b][k],a[b+1][k]]=[a[b+1][k],a[b][k]]})});return a},
uP=(sg,j,k,v)=>{let ci=k>>1,si=k&1,p=sg[ci*2+si],pA=sg[ci*2+(1-si)], P=v, B=si?v:pA[j]-p[j];
si&&(B=v,P=(p[j]+pA[j])/2);
p[j]=P-B/2;
pA[j]=P+B/2;
},
dL=(i,p,l1,sr)=>{let b=s[i],r=FP.p[p],{ty}=IX(r);if(MD==0){if(ty==1){l1&&(l1.innerHTML=b.slice(0,6).map((c,x)=>x&1?'':fx(c[p])+' '+fx(s[i][x+1][p])).filter(Boolean).join('<br>'));C(l1,'display:block;text-align:center;line-height:1.2;white-space:nowrap;');sr&&C(sr,'display:none')}else{let [lv,rv]=[b[0][p],b[1][p]];l1&&W(l1,fx(lv));sr&&(W(sr,(ty||lv!=rv)?fx(rv):''),C(sr,'display:'+((ty||lv!=rv)?'block':'none')))}}else{let P=[0,2,4].map(k=>(b[k][p]+b[k+1][p])/2),B=[0,2,4].map(k=>b[k+1][p]-b[k][p]);l1&&(l1.innerHTML=P.map((pv,x)=>fx(pv)+' '+fx(B[x])).join('<br>'));C(l1,'display:block;text-align:center;line-height:1.2;white-space:nowrap;');sr&&C(sr,'display:none')}},
U,mo,sl=[],ga=[],cv,zm,if$,zo=0,zs=1,dt=[],gl,g2,pg,p2,rH=null,ZW=null,
T$=()=>s.slice(0,-1).reduce((a,b)=>a+b[0][0],0),ti=(T,z)=>`t=${(zo*T).toFixed(2)}s-${((zo+zs)*T).toFixed(2)}s${z?' Zoom√ó'+(1/zs).toFixed(1):''}`,fx=v=>v.toFixed(v==~~v?0:v*10==~~(v*10)?1:2),wI=()=>new Promise(r=>window.requestIdleCallback?requestIdleCallback(r):setTimeout(r,0)),qR=f=>{rH&&cancelIdleCallback(rH);rH=requestIdleCallback(()=>{f();rH=null})},
Li=(a,b,t,T)=>a+(b-a)*t/T,In=(a,b,t,T)=>a*t+(b-a)*t*t/(2*T),Sl=(a,b,T)=>(b-a)/T,
cO=(o0,o1,p0,p1,t,T,hO)=>tp*(hO+In(o0,o1,t,T)+Li(p0,p1,t,T)),
cV=(p,nv,t,T,hO,hM,hA,fi)=>{
let [f0,f1,h0,h1,a0,a1,o0,o1,p0,p1,m0,m1,r0,r1,x0,x1]=
[p[1],nv[1],p[2],nv[2],p[3],nv[3],p[4],nv[4],p[5],nv[5],p[6],nv[6],p[7],nv[7],p[8],nv[8]],
Ag=cO(o0,o1,p0,p1,t,T,hO),Os=sn(Ag),Oc=cs(Ag),Oi=Os;
if(fi==1){
let AmAg=cO(r0,r1,x0,x1,t,T,hA),Amv=(sn(AmAg)+1)/2,C=Li(m0,m1,t,T);
return sn(tp*(hM+In(f0,f1,t,T)+Li(h0,h1,t,T)+Li(a0,a1,t,T)/2*Oi))*(C+(1-C)*Amv);
}
return fi==2?Li(f0,f1,t,T)+Sl(h0,h1,T)+Li(a0,a1,t,T)*Li(o0,o1,t,T)*pi*Oc:Sl(f0,f1,T)-Li(a0,a1,t,T)*Li(o0,o1,t,T)**2*2*pi*pi*Oi;
},
cS=(tg,of,n,p,nv,T,hC,hM,hA,fi)=>{let dt=T/n,mn=1e9,mx=-1e9,vls=new Float32Array(n);for(let i=0;i<n;i++){let v=cV(p,nv,i*dt,T,hC,hM,hA,fi);vls[i]=v;if(fi!=1){mn=mi(mn,v);mx=ma(mx,v)}}tg.set(vls,of);return {mn,mx}},
gD=async(n,T,ss,kS,fi,fC,cT,oP)=>{let ds=Array(2).fill().map(()=>[]),st=Array(2).fill().map(()=>new Float32Array(n)),sm=fi==1?Array(2).fill().map(()=>new Float32Array(n)):null,to=0,hC=[0,0],hM=[0,0],hA=[0,0],mn=fi==1?[-1,-1]:[1e9,1e9],mx=fi==1?[1,1]:[-1e9,-1e9],ln=ss.length-1,pC=fi==1?tp*fC/SR:0,cP=[0,0];for(let ix=0;ix<ln;ix++){C$(cT);let sg=ss[ix],sn$=ss[ix+1],dT=sg[0][0],ns=~~(n*dT/T);for(let k=0;k<2;k++){let p=sg[kS+k],nv=sn$[kS+k],{mn:da_mn,mx:da_mx}=cS(st[k],to,ns,p,nv,dT,hC[k],hM[k],hA[k],fi);if(fi==1){let vw=st[k].subarray(to,to+ns),sw=sm[k].subarray(to,to+ns);for(let i=0;i<ns;i++){sw[i]=vw[i]*sn(cP[k]);cP[k]+=pC;cP[k]>=tp&&(cP[k]-=tp)}}else{mn[k]=mi(mn[k],da_mn);mx[k]=ma(mx[k],da_mx)}hC[k]+=In(p[4],nv[4],dT,dT);hM[k]+=In(p[1],nv[1],dT,dT);hA[k]+=In(p[7],nv[7],dT,dT);}to+=ns;oP&&(await wI(),C$(cT),oP(ix/ln));}C$(cT);let gm=[mi(...mn),ma(...mx)],ri=65535/(gm[1]-gm[0]||1);ds.forEach((d,k)=>{let pU=new Uint16Array(n),sv=st[k];for(let i=0;i<n;i++)pU[i]=ma(0,mi(65535,~~((sv[i]-gm[0])*ri)));d.push(fi==1?{p:pU,gm,f:sm[k]}:{p:pU,gm})});return ds.map(d=>d[0])},
DC=async(n,T,ss,cT,oP)=>{let dr=[],dA=[[],[],[]],cM=['R','V','B'],cL=['signal','fr√©quence','chirp'];for(let c=0;c<3;c++){C$(cT);for(let y=0;y<3;y++)dA[y].push(...await gD(n,T,ss,c*2,y+1,y==0?FC[c]:null,cT,oP&&(p=>oP((y+1+c)*.08+.033*p,`Calcul ${cL[y]} ${cM[c]} ${~~(p*100)}%`))));}dA.forEach(ds=>dr.push(ds[0],ds[2],ds[4],ds[1],ds[3],ds[5]));return dr},
iG=ca=>{let g=ca.getContext('webgl2',{alpha:!1,antialias:!0,preserveDrawingBuffer:!0});if(!g)return null;let vs=g.createShader(g.VERTEX_SHADER),fs=g.createShader(g.FRAGMENT_SHADER);g.shaderSource(vs,'#version 300 es\nin vec2 p;void main(){gl_Position=vec4(p,0,1);}');g.shaderSource(fs,'#version 300 es\nprecision mediump float;uniform vec3 c;out vec4 fragColor;void main(){fragColor=vec4(c,1);}');[vs,fs].forEach(sh=>g.compileShader(sh));if(![vs,fs].every(sh=>g.getShaderParameter(sh,g.COMPILE_STATUS)))return null;let pg=g.createProgram();[vs,fs].forEach(sh=>g.attachShader(pg,sh));g.linkProgram(pg);return g.getProgramParameter(pg,g.LINK_STATUS)?{g,pg}:null},
dr=(ca,os,z,T,iZ)=>{let r=gR(ca),dp=devicePixelRatio,w=r.width*dp,h=r.height*dp;ca.width=w;ca.height=h;let g=iZ?g2:gl,pg$=iZ?p2:pg;if(!g){let in$=iG(ca);if(!in$)return;g=in$.g;pg$=in$.pg;iZ?(g2=g,p2=pg$):(gl=g,pg=pg$)}g.viewport(0,0,w,h);g.clearColor(os?0:.067,os?0:.067,os?0:.067,1);g.clear(g.COLOR_BUFFER_BIT);if(!dt.length)return;g.useProgram(pg$);let lw=iZ?8:1,pL=g.getAttribLocation(pg$,'p'),cL=g.getUniformLocation(pg$,'c'),hS=h/18,cM=[[1,.27,.27],[.27,1,.27],[.27,.27,1]];dt.forEach((d,gi)=>{g.lineWidth(gi>=6&&gi<=17&&!iZ?4:lw);let st=~~(os*d.p.length),ed=mi(d.p.length,~~((os+z)*d.p.length)),zp=os?d.p.subarray(st,ed):d.p,yB=gi*hS,dL=zp.length,pd=zp,mS=w<<1;if(dL>mS){let sp=~~(dL/mS),nL=~~(dL/sp);pd=new Uint16Array(nL);for(let i=0;i<nL;i++)pd[i]=zp[i*sp]}let rL=pd.length<<1;(!SB||SB.length<rL)&&(SB=new Float32Array(rL));let vt=SB.subarray(0,rL),pL$=pd.length-1||1,yS=yB+hS,scY=hS/65535,ofY=1-yB/h*2,sc2=2/h;for(let i=0;i<pd.length;i++){vt[i<<1]=i/pL$*2-1;vt[(i<<1)+1]=ofY-(65535-pd[i])*scY*sc2}let bf=d.buffer,vL=vt.length;if(!bf||d.vL!==vL){bf&&g.deleteBuffer(bf);bf=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,bf);g.bufferData(g.ARRAY_BUFFER,vt,g.DYNAMIC_DRAW);d.buffer=bf;d.vL=vL}else{g.bindBuffer(g.ARRAY_BUFFER,bf);g.bufferSubData(g.ARRAY_BUFFER,0,vt)}g.enableVertexAttribArray(pL);g.vertexAttribPointer(pL,2,g.FLOAT,!1,0,0);g.uniform3fv(cL,cM[gi%3]);g.drawArrays(g.LINE_STRIP,0,pd.length)})},
J=async()=>{let Tt=T$();$cancelToken++;const cT=$cancelToken;if(!mo){mo=mk('div','','position:relative;width:100%;height:25vh;background:#000;color:#fff;border-top:2px solid #fff;');cv=mk('canvas','','border:1px solid #fb4;'+BASES+'height:100%;display:block;');zm=mk('canvas','',BASES+'height:100%;display:block;min-height:0;background:#000');if$=mk('div',ti(Tt),'position:absolute;top:0.2vmin;right:0.5vmin;color:#fb4;'+S1+'pointer-events:none;z-index:101');let ct=mk('div','',BASES+'height:100%;position:relative;min-height:0');ap(ct,if$,cv);ap(mo,ct);ev(cv,'click',()=>{if(ZW)return;let T=T$(),zM=mk('div','','position:fixed;top:26vh;left:0vmin;width:100vw;height:25vh;background:#000;color:#fff;'+BR+S1+'z-index:1001;'+D+'flex-direction:column;align-items:center;border:2px solid #fb4'),zW=mk('div','',BASES+'height:100%;position:relative;min-height:0;');ZW=zM;let cl=mk('div','‚ùå','position:absolute;top:0.5vmin;right:0.5vmin;'+IR+'z-index:102');ev(cl,'click',()=>{(ZW.remove(),ZW=null)});let zI=mk('div',ti(T,1),'position:absolute;top:2vmin;right:5vmin;color:#fb4;'+S1+'pointer-events:none;z-index:102');ap(zW,zm,zI,cl);ap(zM,zW);ap(d.body,zM);dr(zm,zo,zs,T,!0);let um=e=>{let rt=gR(e.target),x=((e.touches?.[0]??e).clientX-rt.left)/rt.width,T=T$();zo=ma(0,mi(1-zs,x-zs/2));dr(zm,zo,zs,T,!0);W(zI,ti(T,1))};ev(zm,'mousemove',um);ev(zm,'touchmove',um);ev(zm,'wheel',e=>{e.preventDefault();let nz=ma(.01,mi(1,zs*(1+e.deltaY*-.001))),T=T$();zo=ma(0,mi(1-nz,zo+(zs-nz)/2));zs=nz;dr(zm,zo,zs,T,!0);W(zI,ti(T,1))})})};zs=1/Tt;zo=0;try{dt=await DC(~~(Tt*441),Tt,s,cT,p=>W(if$,`‚è≥ ${~~((p-.1)/.3*100)}% - ${p<.4?'Calcul courbes':p}`));queueMicrotask(()=>{dr(cv,0,1,Tt);dr(zm,zo,zs,Tt,!0);W(if$,ti(Tt))});}catch(e){if(e==='A'){W(if$,'‚ùå Annul√©');return}throw e}},
rg=(n,x,t,v)=>Object.assign(c('input'),{type:'range',value:v,min:n,max:x,step:t,style:'width:100%;margin:0',onclick:e=>e.stopPropagation()}),
gS_=(r,ib)=>{let {gl,gb,st}=IX(r);return{mn:(ib?gb:gl)[0],mx:(ib?gb:gl)[1],st}},
gL=(r,j,k,v,m)=>j==0?{tx:`${EM[j]} ${fx(v)}`}:m==0?{tx:`${['üî¥','üü¢','üîµ'][k>>1]}${['G','D'][k&1]} ${fx(v)}`}:{tx:`${['üî¥','üü¢','üîµ'][k>>1]}${['P','B'][k&1]} ${fx(v)}`},
bF=(tx,sl,sp,uSV)=>{let b=mk('div',tx,S0+CU+'width:5vmin;text-align:center;');ev(b,'click',e=>{e.stopPropagation();uSV(+sl.value+(tx.includes('‚´∑')?-10:tx.includes('‚´∏')?10:tx.includes('‚™°')?-1:1)*sp)});return b},
cS$=(r,j,k,v,m,uFx)=>{let sp=gS_(r,m==1&&k%2),step=sp.st,prec=(step.toString().split('.')[1]?.length||0),lb=gL(r,j,k,v,m),lT=mk('div',lb.tx,S0+'text-align:center;flex-grow:1;'),sl=rg(sp.mn,sp.mx,step,v),aC=mk('div','',D+'justify-content:space-between;align-items:center;'),uSV=nv=>{nv=ma(sp.mn,mi(sp.mx,nv));nv=parseFloat(nv.toFixed(prec));sl.value=nv;W(lT,gL(r,j,k,nv,m).tx);uFx(nv)};ev(sl,'input',()=>uSV(+sl.value));ap(aC,bF('‚´∑',sl,step,uSV),bF('‚™°',sl,step,uSV),lT,bF('‚™¢',sl,step,uSV),bF('‚´∏',sl,step,uSV));let ct=mk('div','',D+'flex-direction:column;'+G1);ap(ct,aC,sl);return {container:ct,lT,sl};},
uL=(i,p,l1)=>{l1&&dL(i,p,l1,l1.nextElementSibling);uc();uW();qR(()=>mo&&J())},
uW=()=>{let cW=new Array(10).fill(0);pb.forEach(btn=>{btn.style.width='';btn.style.minWidth=''});pb.forEach((btn,k)=>{let w=btn.offsetWidth,j=k%10;w>cW[j]&&(cW[j]=w)});pb.forEach((btn,k)=>{let j=k%10,mW=cW[j];if(mW){let pW=(ma(mW/e.clientWidth*100,7)).toFixed(2)+'vmin';btn.style.width=pW;btn.style.minWidth=pW}})},
hS=e=>{ga.forEach(el=>el.style.display='none');sl.forEach(r=>r.forEach(el=>el.style.display='none'));E.forEach(b=>{b[1].style.display='none';b[2].style.display='none'})},
cI_s=(r,j,v,sd,uFx)=>{let ct1=mk('div','',D+'flex-direction:column;flex:1;'+G1),t1=mk('div','Valeur',C1+'#4af;font-weight:bold;'+S1);ap(ct1,t1);let {container}=cS$(r,j,0,v,0,uFx);ap(ct1,container);ap(sd,ct1);ev(sd,'click',e=>e.stopPropagation());return ()=>sd.style.display='none'},
cI=(r,j,vs,vs2,sd)=>{if(j===0){const uF=(v)=>{s.forEach(c=>c.forEach(p=>p[j]=v));At();qR(()=>mo&&J())};return cI_s(r,j,vs[0],sd,uF)}let dG=mk('div','',D+'gap:2vmin;'),cts=[mk('div','',D+'flex-direction:column;flex:1;'+G1),mk('div','',D+'flex-direction:column;flex:1;'+G1)],ts=['G/D','P/B'];ts.forEach((tx,i)=>{let t=mk('div',tx,C1+(i?'#4f4':'#4af')+';font-weight:bold;'+S1);ap(cts[i],t)});const uFg=(k)=>(v)=>{let {ty}=IX(r);if(ty===1){s.forEach(sg=>sg[k][j]=v)}else{!ty&&s.forEach(c=>c.forEach(p=>p[j]=v))}At();qR(()=>mo&&J())};const uFp=(k)=>(v)=>{s.forEach(sg=>uP(sg,j,k,v));At();qR(()=>mo&&J())};vs.forEach((v,k)=>{let {container}=cS$(r,j,k,v,0,uFg(k));ap(cts[0],container)});vs2.forEach((v,k)=>{let {container}=cS$(r,j,k,v,1,uFp(k));ap(cts[1],container)});cts.forEach(ct=>ap(dG,ct));ap(sd,dG);ev(sd,'click',e=>e.stopPropagation());return ()=>sd.style.display='none';},
bs_s=(r,j,b,i,l1,sd)=>{let v=b[0][j];const uF=(v)=>{s[i].forEach(c=>c[j]=v)},ct1=mk('div','',D+'flex-direction:column;flex:1;'+G1),t1=mk('div','Valeur',C1+'#4af;font-weight:bold;'+S1);ap(ct1,t1);const uFx=(v)=>{uF(v);uL(i,j,l1)};let {container}=cS$(r,j,0,v,0,uFx);ap(ct1,container);ap(sd,ct1);ev(sd,'click',e=>e.stopPropagation());return ()=>sd.style.display='none'},
bs=(r,j,b,i,l1,sr,w,sd)=>{let {ty}=IX(r);if(j===0)return bs_s(r,j,b,i,l1,sd);let iv=ty===1?b.map(x=>x[j]):[b[0][j],b[1][j]],iv2=[0,2,4].flatMap(k=>[(b[k][j]+b[k+1][j])/2,b[k+1][j]-b[k][j]]),sls1=[],lTs1=[],sls2=[],lTs2=[],refreshOpposite=(sourceIsGD)=>{let b=s[i];if(sourceIsGD){let iv2_recalc=[0,2,4].flatMap(k=>[(b[k][j]+b[k+1][j])/2,b[k+1][j]-b[k][j]]);iv2_recalc.forEach((v,k)=>{sls2[k].value=v;W(lTs2[k],gL(r,j,k,v,1).tx)})}else{[0,1,2,3,4,5].forEach(k=>{sls1[k].value=b[k][j];W(lTs1[k],gL(r,j,k,b[k][j],0).tx)})}},uFg=(k)=>(v)=>{let {ty}=IX(r);if(ty===1){s[i][k][j]=v}else{j===0&&k===0?s[i].forEach(c=>c[j]=v):s[i][k][j]=v}refreshOpposite(true);uL(i,j,l1)},uFp=(k)=>(v)=>{uP(s[i],j,k,v);refreshOpposite(false);uL(i,j,l1)};let dG=mk('div','',D+'gap:2vmin;'),cts=[mk('div','',D+'flex-direction:column;flex:1;'+G1),mk('div','',D+'flex-direction:column;flex:1;'+G1)],ts=['G/D','P/B'];ts.forEach((tx,idx)=>{let t=mk('div',tx,C1+(idx?'#4f4':'#4af')+';font-weight:bold;'+S1);ap(cts[idx],t)});iv.forEach((v,k)=>{let {container:ct,lT,sl}=cS$(r,j,k,v,0,uFg(k));sls1.push(sl);lTs1.push(lT);ap(cts[0],ct)});iv2.forEach((v,k)=>{let {container:ct,lT,sl}=cS$(r,j,k,v,1,uFp(k));sls2.push(sl);lTs2.push(lT);ap(cts[1],ct)});cts.forEach(ct=>ap(dG,ct));ap(sd,dG);ev(sd,'click',e=>e.stopPropagation());return ()=>sd.style.display='none'},
gT=(r,j)=>{let {lb,ty}=IX(r),hL=lb,m=hL.match(/(.*)(\(.*\))$/);if(m){let lB=m[1],uN=m[2];if(j>=3&&j<=5){let pS=[];if(lB.includes('Osc')){pS.push('Osc');pS.push(lB.replace('Osc',''))}else{pS.push(lB)}hL=pS.filter(p=>p.length).join('<br>')+'<br>'+uN}else hL=lB+'<br>'+uN}else hL=lb+'<br>'+(ty==0?'(sec)':ty==1?'(Hz)':'(tours)');let ig=ty==1?Array(6).fill(r[1][0]):[r[1][0],r[1][0]],ig2=[(r[1][0]+r[1][0])/2,(r[1][0]+r[1][0])/2,(r[1][0]+r[1][0])/2,0,0,0];return {hL,ig,ig2}},
gP=(p,r,j,i,b,isG)=>{let w=mk('div','',isG?S5G:S5);let l1=c('div'),sr=c('div'),sd=mk('div','',S6);isG?ga[j]=sd:sl[i][j]=sd;let initFunc=null;if(isG){let {hL,ig,ig2}=gT(r,j);let l3=mk('div',r[0],S2);let val1=mk('div','',S1+C1+'#000;');val1.innerHTML=hL;initFunc=()=>cI(r,j,ig,ig2,sd);ap(w,l3,val1,sd)}else{[l1,sr].forEach(el=>C(el,S1+C1+'#000'));dL(i,j,l1,sr);initFunc=()=>bs(r,j,b,i,l1,sr,w,sd);ap(w,l1,sr,sd)}initFunc();ev(w,'click',e=>{e.stopPropagation();hS();let r$=gR(w);sd.style.top=(r$.bottom+5)+'px';sd.style.display='block'});ap(p,w);pb.push(w);return w},
K=()=>{let g=mk('div','','position:sticky;top:0;left:0;right:0;z-index:999;background:linear-gradient(45deg,#ff0,#f0f,#0ff,#0f0);'+PD+S1),h=mk('div','',D+'justify-content:space-between;align-items:center;'),ht=mk('div','üåàSpiraStrober',C1+'#000;'+S2+'cursor:default;'),hb=mk('div','',D+G1),BTActions=[()=>go(()=>s.forEach((g,k)=>k&&(s[k]=cp(s[0])))),()=>go(()=>s.forEach((g,k)=>{if(k){let n=cp(s[0]);k%2&&(n=sw(n));s[k]=n}})),()=>go(()=>s.forEach(FX)),()=>go(()=>s.forEach((_,k)=>s[k]=rv())),()=>go(()=>s.forEach(UN)),()=>go(()=>s.forEach(PO))];BT.slice(0,6).forEach((em,i)=>{let b=mk('div',em,IB);ev(b,'click',BTActions[i]);ap(hb,b)});ap(h,ht,hb);let p=mk('div','',S4);FP.p.forEach((r,j)=>{let w=gP(p,r,j,null,null,true);GB.push(w)});let wM=mk('div','',S5G+D+'flex-direction:row;gap:0.5vmin;'),bd=mk('div','üîª',ICO),bu=mk('div','üî∫',ICO),br=mk('div','‚ôªÔ∏è',ICO);ap(wM,bd,bu,br);ap(p,wM);ap(g,h,p);return g},
L=i=>{let a=['div','h1','h2','p','div'].map(c),b=s[i],cl=G(i),gr=H(i,50);C(a[0],`border:0;border-radius:0;background:${gr};${P5}position:relative;${S1}`+D+'align-items:center;justify-content:space-between;gap:0.5vmin;');let aD=()=>s.length>1&&sE(()=>s.splice(i,1)),pd=mk('div','',D+'align-items:center;'+G1+'flex-grow:1;min-width:0;');sl[i]=[];FP.p.forEach((r,j)=>{gP(pd,r,j,i,b,false)});let sW='position:absolute;top:0;right:0;width:28vmin;background:'+Ct+';'+BR+'z-index:10;'+D+'flex-wrap:wrap;align-items:center;justify-content:space-around;padding:1vmin;gap:1vmin;display:none;',ms=[mk('div','',sW),mk('div','',sW)],
actionConfigs=[
{style:IG, rm:'cM', target:ms[0], actions:[()=>sE(()=>s.splice(i+1,0,cp(s[i]))),()=>sE(()=>s.splice(i+1,0,sw(cp(s[i])))),()=>sE(()=>{let a=rv();FX(a);s.splice(i+1,0,a)}),()=>sE(()=>s.splice(i+1,0,rv())),()=>sE(()=>{let a=rv();UN(a);s.splice(i+1,0,a)}),()=>sE(()=>s.splice(i+1,0,rvS()))]},
{style:IY, rm:'mM', target:ms[1], actions:[()=>i&&sE(()=>s[i]=cp(s[i-1])),()=>sE(()=>s[i]=sw(cp(s[i]))),()=>sE(()=>FX(s[i])),()=>sE(()=>s[i]=rv()),()=>sE(()=>UN(s[i])),()=>sE(()=>PO(s[i]))]}
];
actionConfigs.forEach(({style:st,rm,target:tg,actions:f})=>{BT.slice(0,6).forEach((em,k)=>{let b=mk('div',em,st+IM);ev(b,'click',e=>{e.stopPropagation();RM_T=rm;RM_I=i;f[k]()});ap(tg,b)})});
let wA=mk('div','',S5+D+'flex-direction:row;gap:0.5vmin;flex-shrink:0;'),bD=mk('div',BT[6],IR);C(bD,`opacity:${s.length<=1?.3:1};${bD.style.cssText}`);ev(bD,'click',aD);let bM=mk('div','üìù',IR);ev(bM,'click',e=>{e.stopPropagation();hS();ms[1].style.display='flex'});let bA$=mk('div','‚ú¥Ô∏è',IY);ev(bA$,'click',e=>{e.stopPropagation();hS();ms[0].style.display='flex'});ap(wA,bM,bA$,bD);ap(pd,wA);ap(a[0],pd,...ms);return [a[0],ms[0],ms[1]]},
uc=()=>E.forEach((el,i)=>el[0].style.background=H(i,50)),
At=()=>(E.length=0,sl.length=0,pb.length=0,pb.push(...GB),U[4].replaceChildren(),s.forEach((a,i)=>{let b=L(i);E[i]=b;ap(U[4],b[0])}),z(),uc(),uW(),J(),(()=>{if(RM_T&&RM_I!==-1&&E[RM_I]){let mE=RM_T==='mM'?E[RM_I][2]:E[RM_I][1];if(mE){hS();mE.style.display='flex'}RM_T=null;RM_I=-1}})()),
z=()=>W(U[5],`Configuration-${s.length-1} s√©quences-${T$()}s`),
eA=async oP=>{let tD=T$();$cancelToken++;const cT=$cancelToken;if(tD<=0||s.length<=1)throw new Error('dur√©e nulle');let ts=~~(tD*SR),FP$=18200,FM=20,sC$=sC;try{oP(.05,'Initialisation');await wI();C$(cT);let fL=new Float32Array(ts),fR=new Float32Array(ts);for(let c=0;c<3;c++){let kS=c*2,iN=(sC$>=3)||(sC$===c);if(iN){C$(cT);let dC=await gD(ts,tD,s,kS,1,sC$===3?FC[c]:FC[3],cT,p=>oP(.1+c*.1+.1*p,`Signal ${['Rouge','Vert','Bleu'][c]}${~~(p*100)}%`));let mL=dC[0].f,mR=dC[1].f;for(let j=0;j<ts;j++){fL[j]+=mL[j];fR[j]+=mR[j]}await wI();C$(cT)}}oP(.4,'Encodage direct');await wI();C$(cT);let pP=tp*FP$/SR,pM=tp*FM/SR,AS=.25,AU=sC$<3?.1:.1/3,cS=16384,nC=~~((ts+cS-1)/cS),hW=44+ts*4,wA=new ArrayBuffer(hW),wV=new DataView(wA),ws=(o,s)=>[...s].forEach((c,i)=>wV.setUint8(o+i,c.charCodeAt(0)));
const headerMap=[
  {offset:0, value:'RIFF', size:4, type:'string'},{offset:8, value:'WAVE', size:4, type:'string'},{offset:12, value:'fmt ', size:4, type:'string'},{offset:36, value:'data', size:4, type:'string'},
  {offset:4, value:36+ts*4, size:4, type:'Uint32'},{offset:16, value:16, size:4, type:'Uint32'},{offset:20, value:1, size:2, type:'Uint16'},{offset:22, value:2, size:2, type:'Uint16'},
  {offset:24, value:SR, size:4, type:'Uint32'},{offset:28, value:SR*4, size:4, type:'Uint32'},{offset:32, value:4, size:2, type:'Uint16'},{offset:34, value:16, size:2, type:'Uint16'},
  {offset:40, value:ts*4, size:4, type:'Uint32'}
];
headerMap.forEach(({offset,value,size,type})=>{
    if(type==='string')ws(offset,value);
    else wV['set'+type](offset,value,1)
});
let wO=44,ph=[0,0],wS=v=>{wV.setInt16(wO,v*32767|0,1);wO+=2};if(sC$===3){for(let ck=0;ck<nC;ck++){let st=ck*cS,ed=mi((ck+1)*cS,ts),ln=ed-st;for(let j=0;j<ln;j++){let cP=sn(ph[0]),m=sn(ph[1]);wS(fL[st+j]*AS+cP*AS*(1-m)*.5);wS(fR[st+j]*AS+cP*AS*(1+m)*.5);ph[0]+=pP;ph[0]>=tp&&(ph[0]-=tp);ph[1]+=pM;ph[1]>=tp&&(ph[1]-=tp)}!(ck%8)&&(await wI(),C$(cT),oP(.4+.5*((ck+1)/nC),`Encodage (Spectra): ${~~((ck+1)/nC*100)}%`))}}else{for(let ck=0;ck<nC;ck++){let st=ck*cS,ed=mi((ck+1)*cS,ts),ln=ed-st;for(let j=0;j<ln;j++){wS(fL[st+j]*AU);wS(fR[st+j]*AU)}!(ck%8)&&(await wI(),C$(cT),oP(.4+.5*((ck+1)/nC),`Encodage (${['Rouge','Vert','Bleu'][sC$]||'Unifi√©'}): ${~~((ck+1)/nC*100)}%`))}}oP(.9,'Finalisation');await wI();C$(cT);aP.src=URL.createObjectURL(new Blob([wA],{type:'audio/wav'}));oP(1,'Termin√©')}catch(er){if(er==='A')throw new Error('Op√©ration annul√©e.');throw er}},
sC=0,aP,fC;U=['body','h1','h2','p','div','h2'].map(c);C(U[0],'padding-bottom:0;padding-top:0;');[U[1],U[3]].forEach(el=>ap(U[0],el));let tC=mk('div','','overflow-x:auto;width:100%;'),tW=mk('div','','min-width:fit-content;display:flex;flex-direction:column;');
ap(tW,K(),U[4]);ap(tC,tW);ap(U[0],tC,U[5]);ap(e,U[0]);Array.from({length:11},()=>s.push(rvS()));At();ev(window,'load',()=>{fC=mk('div','','position:sticky;bottom:0;left:0;right:0;z-index:998;width:100%;');let eU=mk('div','','position:relative;width:100%;padding:0.5vmin 1vmin;min-height:12vmin;background:#111;z-index:1000;'+D+'flex-direction:column;gap:1vmin;border-top:1px solid #f83;'),eR=mk('div','',D+'align-items:center;'+G1),cL=mk('label','',C1+'#000;'+D+'align-items:center;font-size:3vmin;gap:5px;height:5vmin;width:18vw;'),cS$=mk('select','','height:5vmin;background:#f83;color:white;'+BR+'font-size:3vmin;');ap(fC,mo);sC=3;['üî¥Rouge','üü¢Vert','üîµBleu','üåàSpectra','‚òÄÔ∏èUnifi√©',].forEach((n,i)=>{let o=mk('option',n,'');o.value=i;ap(cS$,o)});cS$.value=sC;ev(cS$,'change',e=>sC=parseInt(e.target.value));ap(cL,cS$);let bM=mk('div','',D+'align-items:center;');ap(bM,cL);let sP=(tx,ps)=>{let tp$=mk('div',tx,S9),cl=mk('div','‚ùå','position:absolute;top:1vmin;right:1vmin;'+IR);ev(cl,'click',()=>tp$.remove());ps&&ap(tp$,...ps);ap(tp$,cl);ap(d.body,tp$);setTimeout(()=>d.addEventListener('click',()=>tp$.parentNode&&tp$.remove(),{once:!0}),10)},tF=[mk('div',"‚à´T(X·µ¢)=X·µ¢‚ãÖt+(X·µ¢‚Çä‚ÇÅ-X·µ¢)t¬≤/(2‚è≥)\nT(X·µ¢)=X·µ¢+(X·µ¢‚Çä‚ÇÅ-X·µ¢)t/‚è≥\nT'(X·µ¢)=(X·µ¢‚Çä‚ÇÅ-X·µ¢)/‚è≥ \nO·µ¢=‚à´T(üí´·µ¢)+T(üìå·µ¢)+O‚ÇÄ\nA·µ¢=‚à´T(‚≠ê·µ¢)+T(üìç·µ¢)+A‚ÇÄ",C1+'#f90;'+S2),mk('div',"S·µ¢=sin(2œÄ‚ãÖœÜ·µ¢)‚ãÖ((1-T(üèÆ·µ¢))‚ãÖ(sin(2œÄ‚ãÖA·µ¢)+1)/2+T(üèÆ·µ¢))\nœÜ·µ¢=‚à´T(üîî·µ¢)+T(üö©·µ¢)+œÜ‚ÇÄ+T(üåÄ)/2‚ãÖsin(2œÄ‚ãÖO·µ¢)\nf·µ¢=T(üîî·µ¢)+T'(üö©·µ¢)+T(üåÄ)‚ãÖT(üí´)‚ãÖœÄ‚ãÖcos(2œÄ‚ãÖO·µ¢)\nk·µ¢=T'(üîî·µ¢)-T(üåÄ)‚ãÖT(üí´)¬≤‚ãÖ2œÄ¬≤‚ãÖsin(2œÄ‚ãÖO·µ¢)",C1+'#f00;'+S2)],bL=mk('div','üí°',IB+BASES.replace('100%','7vw')+D+DCEN+'height:5vmin;');ev(bL,'click',e=>{e.stopPropagation();sP('',tF)});let eB=mk('button','üéµ G√©n√©rer','background:#4af;color:black;border:none;padding:1vmin 2vmin;'+BR+'font-size:3vmin;'+CU+'height:5vmin;position:relative;overflow:hidden;flex-grow:1;min-width:40vw;'),eBg=mk('div','','position:absolute;left:0;top:0;height:100%;width:0%;background:linear-gradient(90deg,#0f0,#4f4);transition:width 0.3s;z-index:0;'),eBt=mk('span','üéµ G√©n√©rer','position:relative;z-index:1;color:black;');ap(eB,eBg,eBt);let bS=mk('button','‚èπÔ∏è Stop','background:#f44;color:black;border:none;padding:1vmin 2vmin;'+BR+'font-size:3vmin;'+CU+'height:5vmin;width:15vw;position:relative;overflow:hidden;');ev(bS,'click',()=>{$cancelToken++;eBt.textContent='‚èπÔ∏è Annul√©';eBg.style.width='0%';eB.disabled=false;setTimeout(()=>{eBt.textContent='üéµ G√©n√©rer';},2000)});aP=mk('audio','',BASES+'height:5vmin;');aP.controls=!0;ev(eB,'click',async()=>{eB.disabled=!1;eBg.style.width='0%';try{await eA((p,mg)=>{eBg.style.width=(p*100)+'%';eBt.textContent=mg?`‚è≥ ${~~(p*100)}% - ${mg}`:`‚è≥ ${~~(p*100)}%`});eBg.style.width='100%';eBt.textContent='‚úÖ Termin√©';setTimeout(()=>{eBt.textContent='üéµ G√©n√©rer';eBg.style.width='0%';eB.disabled=!1},2000)}catch(er){console.error(er);if(er.message!=='Op√©ration annul√©e.')eBt.textContent='‚èπÔ∏è Erreur';else eBt.textContent='‚èπÔ∏è Annul√©';setTimeout(()=>{eBt.textContent='üéµ G√©n√©rer';eBg.style.width='0%';eB.disabled=!1},2000)}});ap(eR,bL,bM,eB,bS);ap(eU,eR,aP);ap(fC,mo);ap(fC,eU);ap(d.body,fC);d.addEventListener('click',hS);At()});
</script>