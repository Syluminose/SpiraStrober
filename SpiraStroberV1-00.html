<!DOCTYPE html>
<meta charset="utf-8">
<script>
// MIT License Â© 2025 Syluminose
const d=document,c=z=>d.createElement(z),e=d.documentElement,s=[],E=[],ca=new Map;
let U,tm,mo,sl=[],ga=[];
const {max:ma,min:mi,sin:ms,cos:mc,random:mr,abs:ab}=Math,
qA=z=>d.querySelectorAll(z),aL=(t,n,f,o)=>t.addEventListener(n,f,o),gR=t=>t.getBoundingClientRect(),rA=requestAnimationFrame,
W=(t,a)=>t.textContent=a,
C=(t,k)=>t.setAttribute('style',k),
mk=(g,t,s)=>{const l=c(g);t&&W(l,t);s&&C(l,s);return l},
rg=(mn,mx,st,v)=>{const i=c('input');i.type='range';i.value=v;i.min=mn;i.max=mx;i.step=st;C(i,W1+MG+'height:6dvw');return i},
EM=['â³','ðŸ””','âš¡','ðŸŒŠ','ðŸ’«','ðŸŒˆ'],
BT=['ðŸ”¶','ðŸŽ²','ðŸ”'],
COL=['#f44','#fb4','#4af','#4f4','#f4f'],
A='position:absolute;',F='position:fixed;',D1='display:flex;',B='background:',C1='color:',
BR='border-radius:1dvw;',CU='cursor:pointer;',FS='font-size:',
W1='width:100%;',MG='margin:1dvw;',PD='padding:1dvw;',G1='gap:1dvw;',
F1=FS+'3dvw;',F2=FS+'5dvw;',
S2=D1+'justify-content:center;'+G1+PD,
S4=D1+'align-items:center;'+G1+MG+'overflow-x:auto;',
S5='position:relative;'+CU+PD+BR+C1+'white;min-width:7dvw;'+D1+'flex-direction:column;align-items:center;height:12dvw;justify-content:center;'+B,
S6=F+'left:10dvw;width:80dvw;z-index:1000;'+B+'#000;'+BR+PD+'display:none',
S9=F+'top:50%;left:50%;transform:translate(-50%,-50%);width:90dvw;'+B+'#000;'+C1+'#fff;'+PD+BR+F1+'z-index:1001;white-space:pre-line;border:2px solid #fb4',
FP={p:[[EM[0],[0,30],[10,10],1,'Duree(s)',0],[EM[1],[1,40],[1,40],.1,'Freq(Hz)',1],[EM[2],[-.5,.5],[-.5,.5],.01,'Phase(tours)',1],[EM[3],[0,15],[0,15],1,'OscAmp(Hz)',1],[EM[4],[.1,3],[.1,3],.1,'OscFreq(Hz)',1],[EM[5],[0,360],[0,0],1,'Couleur(teinte)',2]]},
G=i=>`hsl(${ma(0,mi(270,ab(s[i][0][1]-s[i][1][1])*9))},100%,50%)`,
H=(i,l)=>i>=s.length-1?`hsl(${ma(0,mi(270,ab(s[i][0][1]-s[i][1][1])*9))},100%,${l}%)`:`linear-gradient(to bottom,${Array.from({length:9},(_,j)=>`hsl(${ma(0,mi(270,ab((s[i][0][1]+(s[i+1][0][1]-s[i][0][1])*j/8)-(s[i][1][1]+(s[i+1][1][1]-s[i][1][1])*j/8))*9))},100%,${l}%)`).join(',')})`,
gr=p=>p[0]===EM[0]||p[0]===EM[1]||p[0]===EM[3]||p[0]===EM[5]?~~(mr()*(p[2][1]-p[2][0]+1))+p[2][0]:+(mr()*(p[2][1]-p[2][0])+p[2][0]).toFixed(2),
rv=()=>[FP.p.map(gr),FP.p.map((p,i)=>p[5]===0?s[0]?s[0][0][i]:gr(p):p[5]===2?50:gr(p))],
cp=a=>[[...a[0]],[...a[1]]],
sw=a=>{FP.p.forEach((pr,k)=>{if(pr[5]&&k)[a[0][k],a[1][k]]=[a[1][k],a[0][k]]});return a},
vc=(n,f0,f1,T,ph0,ph1,oA,oF,phO,fi,b8,phC)=>{
const inv=1/T,dt=T/n,tp=6.283185307179586,A_ph=oA/(2*tp*oF);
if(fi===1){
const cf=(f1-f0)*inv*.5,lin=(f0+(ph1-ph0)*inv)*dt;
return b8?Uint8Array.from({length:n},(_,i)=>{const t=i*dt,ph_osc=A_ph*ms(tp*oF*t+phC);return~~((ms(tp*(phO+cf*t*t+lin*i+ph_osc))*.5+.5)*255)}):Float32Array.from({length:n},(_,i)=>{const t=i*dt,ph_osc=A_ph*ms(tp*oF*t+phC);return ms(tp*(phO+cf*t*t+lin*i+ph_osc))})
}
if(fi===2){
const v=(f1-f0)*inv,b=f0+(ph1-ph0)*inv;
return Float32Array.from({length:n},(_,i)=>{const t=i*dt,f_osc=oA*mc(tp*oF*t+phC)*.5;return v*i*dt+b+f_osc})
}
const Ak=tp*oF*oA*.5;
return Float32Array.from({length:n},(_,i)=>{const t=i*dt,k_osc=Ak*mc(tp*oF*t+phC);return (f1-f0)*inv+k_osc})
},
J=()=>{
clearTimeout(tm);
tm=setTimeout(()=>{
mo?.remove();
d.body.style.paddingBottom='33dvh';
d.body.style.margin='0';
mo=mk('div','',F+'bottom:0;left:0;right:0;height:33dvh;'+B+'#000;'+C1+'#fff;'+PD+'overflow-y:auto;border-top:2px solid #fff;display:grid;grid-template-rows:1fr 1fr;'+G1);
const Tt=s.slice(0,-1).reduce((a,b)=>a+b[0][0],0),
cv=mk('canvas','','border:1px solid #fb4;'+W1+'height:100%;display:block;min-height:0'),
zm=mk('canvas','','border:2px solid #4f4;'+W1+'height:100%;display:block;min-height:0;'+B+'#000'),
info=mk('div','',A+'top:0.2dvw;right:0.5dvw;'+C1+'#fb4;'+F1+'pointer-events:none;z-index:101'),
ctn1=mk('div','','position:relative;min-height:0'),
ctn2=mk('div','','position:relative;min-height:0'),
dr=(c,o,z)=>{
const x=c.getContext('2d'),r=gR(c),dp=devicePixelRatio;
c.width=r.width*dp;c.height=r.height*dp;x.scale(dp,dp);
x.fillStyle=o?'#000':'#111';x.lineWidth=o?2:.8;
x.fillRect(0,0,r.width,r.height);
const h=r.height/3;
dt.forEach((d,gi)=>{
const st=~~(o*d.pl.length),ed=mi(d.pl.length,~~((o+z)*d.pl.length)),
zl=o?d.pl.subarray(st,ed):d.pl,zr=o?d.pr.subarray(st,ed):d.pr,
rg=d.gm[1]-d.gm[0]||1,sc=r.width/zl.length,m=o?.9:.85,yb=gi*h,h2=h/2;
[['#4f4',zl,0],['#f44',zr,h2]].forEach(([cl,p,oy])=>{
x.strokeStyle=cl;x.beginPath();
for(let k=0;k<p.length;k++)x[k?'lineTo':'moveTo'](k*sc,isFinite(p[k])?yb+oy+h2-((p[k]-d.gm[0])/rg)*h2*m:yb+oy+h2);
x.stroke()
});
x.fillStyle='#fb4';x.font=(o?14:12)+'px sans-serif';
x.fillText(['Signal','Freq','Chirp'][gi],o?6:4,yb+(o?18:16))
});
o&&x.fillText(`ZoomÃ—${(1/z).toFixed(1)} t=${(o*Tt).toFixed(2)}s`,r.width-90,18)
};
ctn1.append(info,cv);ctn2.append(zm);mo.append(ctn1,ctn2);
let dt=[],zo=0,zs=1/Tt;
rA(()=>{
const np=~~(Tt*441),nc=new Map;
[1,2,3].forEach(fi=>{
const pl=fi===1?new Uint8Array(np):new Float32Array(np),pr=fi===1?new Uint8Array(np):new Float32Array(np);
let to=0,phL=0,phR=0,phCL=0,phCR=0,mnL=Infinity,mxL=-Infinity,mnR=Infinity,mxR=-Infinity;
s.slice(0,-1).forEach((sg,ix)=>{
const T=sg[0][0],ns=~~(np*T/Tt),tp=6.283185307179586,[f0L,f1L,ph0L,ph1L,oAL,oFL]=[sg[0][1],s[ix+1][0][1],sg[0][2],s[ix+1][0][2],sg[0][3],sg[0][4]],[f0R,f1R,ph0R,ph1R,oAR,oFR]=[sg[1][1],s[ix+1][1][1],sg[1][2],s[ix+1][1][2],sg[1][3],sg[1][4]],
ckL=`${fi}_L_${ns}_${f0L}_${f1L}_${T}_${ph0L}_${ph1L}_${oAL}_${oFL}_${phL}_${phCL}`,ckR=`${fi}_R_${ns}_${f0R}_${f1R}_${T}_${ph0R}_${ph1R}_${oAR}_${oFR}_${phR}_${phCR}`,
vL=ca.get(ckL)||vc(ns,f0L,f1L,T,ph0L,ph1L,oAL,oFL,phL,fi,fi===1,phCL),vR=ca.get(ckR)||vc(ns,f0R,f1R,T,ph0R,ph1R,oAR,oFR,phR,fi,fi===1,phCR);
ca.has(ckL)||ca.set(ckL,vL);ca.has(ckR)||ca.set(ckR,vR);nc.set(ckL,1);nc.set(ckR,1);
pl.set(vL,to);pr.set(vR,to);
if(fi!==1){
for(let i=0;i<vL.length;i++){mnL=mi(mnL,vL[i]);mxL=ma(mxL,vL[i])}
for(let i=0;i<vR.length;i++){mnR=mi(mnR,vR[i]);mxR=ma(mxR,vR[i])}
}
to+=ns;phL+=f0L*T+(f1L-f0L)*T/2+(ph1L-ph0L);phR+=f0R*T+(f1R-f0R)*T/2+(ph1R-ph0R);phCL+=tp*oFL*T;phCR+=tp*oFR*T
});
dt.push({pl,pr,gm:fi==1?[0,255]:[mi(mnL,mnR),ma(mxL,mxR)]})
});
ca.forEach((v,k)=>nc.has(k)||ca.delete(k));
dr(cv,0,1);dr(zm,zo,zs);W(info,`t=${(zo*Tt).toFixed(2)}s-${((zo+zs)*Tt).toFixed(2)}s`);
zm.onmousemove=zm.ontouchmove=e=>{
const rt=gR(e.target),x=((e.touches?.[0]||e).clientX-rt.left)/rt.width;
zo=ma(0,mi(1-zs,x-zs/2));dr(zm,zo,zs);W(info,`t=${(zo*Tt).toFixed(2)}s-${((zo+zs)*Tt).toFixed(2)}s`)
};
zm.onwheel=e=>{
e.preventDefault();
const nz=ma(.01,mi(1,zs*(1+e.deltaY*-.001)));
zo=ma(0,mi(1-nz,zo+(zs-nz)/2));zs=nz;dr(zm,zo,zs);W(info,`t=${(zo*Tt).toFixed(2)}s-${((zo+zs)*Tt).toFixed(2)}s ZoomÃ—${(1/zs).toFixed(1)}`)
}
});
d.body.append(mo)
},2e3)
},
K=()=>{
const g=mk('div','','border:1dvw solid;border-image:linear-gradient(45deg,#ff0,#f0f,#0ff,#0f0,#ff0) 1;'+BR+B+'linear-gradient(45deg,#ff0,#f0f,#0ff,#0f0);'+PD+MG+'position:relative;'+F1),
h=mk('div','',D1+'justify-content:space-between;align-items:center;'),
ht=mk('h3','ðŸ§°Parametres Generaux',C1+'#000;'+F2),
hb=mk('div','',D1+G1),
p=mk('div','',S4);
BT.forEach((em,i)=>{const b=mk('div',em,CU+F2+C1+'#29f;');b.onclick=[()=>s.length>0&&(s.forEach((sg,k)=>k>0&&(s[k]=cp(s[0]))),At()),()=>(s.forEach((_,k)=>s[k]=rv()),At()),()=>s.length>0&&(s.forEach((sg,k)=>{if(k>0){let n=cp(s[0]);k%2==1&&(n=sw(n));s[k]=n}}),At())][i];hb.append(b)});
h.append(ht,hb);
FP.p.forEach((pr,j)=>{
const w=mk('div','',S5+(j==5?'hsl(180,100%,50%)':'#000')),l3=mk('div',pr[0],F2),sd=mk('div','',S6);
ga[j]=sd;
const [il,ir]=[rg(pr[1][0],pr[1][1],pr[3],pr[1][0]),rg(pr[1][0],pr[1][1],pr[3],j==5?50:pr[1][0])];
j==5&&(ir.type='range',ir.value=0,ir.min=0,ir.max=100,ir.step=1);
const ll=mk('div',j==5?'ðŸŒˆTeinte '+il.value:'ðŸ«²Gauche '+il.value,C1+'#4f4;'),rl=mk('div',j==5?'ðŸ’¡Luminosite '+ir.value:'ðŸ«±Droite '+ir.value,C1+'#f44;');
pr[5]||(rl.style.display='none');sd.append(ll,il,rl,ir);
const hs=()=>sd.style.display='none',ag=sd=>{const v=+(sd=='G'?il:ir).value;s.forEach(sg=>(j==5?sg[sd=='G'?0:1][j]=v:pr[5]?sg[sd=='G'?0:1][j]=v:(sg[0][j]=sg[1][j]=v)));At()};
w.onclick=e=>{
e.stopPropagation();
ga.forEach(el=>el.style.display='none');
const r=gR(w);
sd.style.top=(r.bottom+5)+'px';
sd.style.display='block';
w.style.background=j==5?'hsl(180,100%,30%)':'#000';
setTimeout(()=>aL(d,'click',hs,{once:!0}),10)
};
[il,ir].forEach((i,k)=>aL(i,'input',e=>{
j==5?(W([ll,rl][k],['ðŸŒˆTeinte ','ðŸ’¡Luminosite '][k]+e.target.value),w.style.background=`hsl(${k?il.value:e.target.value},100%,${k?e.target.value:50}%)`):W([ll,rl][k],['ðŸ«²Gauche ','ðŸ«±Droite '][k]+e.target.value);
ag(k?'D':'G');mo&&J()
}));
[il,ir,sd].forEach(el=>aL(el,'click',e=>e.stopPropagation()));
w.append(l3,sd);p.append(w)
});
g.append(h,p);return g
},
L=i=>{
const a=['body','h1','p','div'].map(c),b=s[i],cl=G(i),gr=H(i,75),br=H(i,50),tc=cl.replace('50%','75%');
C(a[0],'border:1dvw solid;border-image:'+br+' 1;'+BR+B+gr+';'+PD+MG+'position:relative;'+F1);
const ht=mk('div','',D1+'justify-content:space-between;align-items:center;'),
ti=mk('h1','ðŸ“'+i,C1+'#000;'+F2),
hb=mk('div','',D1+G1);
['âŒ','ðŸ’¡','ðŸ“','ðŸ”¶','ðŸŽ²','ðŸ”'].forEach((em,k)=>{
const bt=mk('div',em,CU+F2+C1+COL[k%5]);
k==0&&(bt.style.opacity=s.length<=1?.3:1);
if(k==1)bt.onclick=e=>{
e.stopPropagation();
const tp=mk('div','',S9),
t1=mk('div','Signal = sin(âš¡)',C1+'#fb4;'),
t2=mk('div','âš¡ = (ðŸ””1-ðŸ””0)tÂ²/2â³ + ðŸ””0t + (âš¡1-âš¡0)t/â³ + Ï†â‚€',C1+'#fb4;'),
t3=mk('div',' + (ðŸŒŠ/2)Â·sin(2Ï€Â·ðŸ’«Â·t + Ï†câ‚€) / 2Ï€ðŸ’«',C1+'#f44;'),
t4=mk('div','freq = dâš¡/dt = (ðŸ””1-ðŸ””0)t/â³ + ðŸ””0 + (âš¡1-âš¡0)/â³',C1+'#fb4;'),
t5=mk('div',' + (ðŸŒŠ/2)Â·cos(2Ï€Â·ðŸ’«Â·t + Ï†câ‚€)',C1+'#f44;'),
t6=mk('div','chirp = dÂ²âš¡/dtÂ² = (ðŸ””1-ðŸ””0)/â³',C1+'#fb4;'),
t7=mk('div',' - Ï€Â·ðŸ’«Â·ðŸŒŠÂ·sin(2Ï€Â·ðŸ’«Â·t + Ï†câ‚€)',C1+'#f44;'),
cl=mk('div','âŒ',A+'top:1dvw;right:1dvw;'+C1+'#f44;'+F2+CU);
cl.onclick=()=>tp.remove();tp.append(t1,t2,t3,t4,t5,t6,t7,cl);d.body.append(tp);setTimeout(()=>aL(d,'click',()=>tp.parentNode&&tp.remove(),{once:!0}),10)
};
else if(k==2)bt.onclick=e=>{e.stopPropagation();const tp=mk('div',FP.p.map(p=>p[0]+p[4]).join('\n'),S9),cl=mk('div','âŒ',A+'top:1dvw;right:1dvw;'+C1+'#f44;'+F2+CU);cl.onclick=()=>tp.remove();tp.append(cl);d.body.append(tp);setTimeout(()=>aL(d,'click',()=>tp.parentNode&&tp.remove(),{once:!0}),10)};
else bt.onclick=[()=>s.length>1&&(s.splice(i,1),At()),null,null,()=>i>0&&(s[i]=cp(s[i-1]),At()),()=>(s[i]=rv(),At()),()=>(s[i]=sw(cp(s[i])),At())][k];
hb.append(bt)
});
ht.append(ti,hb);a[0].append(ht);
const pd=mk('div','',S4);
sl[i]=[];
FP.p.forEach((pr,j)=>{
const w=mk('div','',S5+(j==5?`hsl(${b[0][j]||0},100%,${b[1][j]||50}%)`:'#000')),l3=mk('div',pr[0],F2),[sl1,sr]=[c('div'),c('div')],[lv,rv]=[b[0][j],b[1][j]];
if(j==5)[sl1,sr].forEach(el=>C(el,'display:none'));else if(!pr[5]||lv==rv)(W(sl1,lv),C(sr,'display:none'));else(W(sl1,lv),W(sr,rv));
const sd=mk('div','',S6);
sl[i][j]=sd;
const [il,ir]=[rg(pr[1][0],pr[1][1],pr[3],lv),rg(pr[1][0],pr[1][1],pr[3],!pr[5]||j==5?rv||50:rv)];
pr[5]||(ir.style.display='none');j==5&&(ir.type='range',ir.value=0,ir.min=0,ir.max=100,ir.step=1);
const ll=mk('div',pr[5]?j==5?'ðŸŒˆTeinte '+(lv||0):'ðŸ«² '+lv:'',C1+'#f44;'),rl=mk('div',pr[5]?j==5?'ðŸ’¡Luminosite '+(rv||50):'ðŸ«± '+rv:'',C1+'#4f4;');
pr[5]||(rl.style.display='none');sd.append(ll,il,rl,ir);
const hs=()=>(sd.style.display='none',w.style.background=j==5?`hsl(${s[i][0][j]||0},100%,${s[i][1][j]||50}%)`:'#000');
w.onclick=e=>{
e.stopPropagation();
sl.forEach(r=>r.forEach(el=>el.style.display='none'));
const r=gR(w);
sd.style.top=(r.bottom+5)+'px';
sd.style.display='block';
w.style.background=j==5?`hsl(${lv||0},100%,30%)`:cl.replace('50%','5%');
setTimeout(()=>aL(d,'click',hs,{once:!0}),10)
};
[il,ir].forEach((inp,k)=>aL(inp,'input',e=>{
s[i][k][j]=+e.target.value;
j==5?(W([ll,rl][k],['ðŸŒˆTeinte ','ðŸ’¡Luminosite '][k]+e.target.value),w.style.background=`hsl(${k?lv:e.target.value},100%,${k?e.target.value:rv||50}%)`):
(W([ll,rl][k],['ðŸ«² ','ðŸ«± '][k]+e.target.value),!pr[5]&&!k?(s[i][1][j]=+e.target.value,W(sl1,e.target.value)):pr[5]>0&&((()=>{const [nlv,nrv]=[s[i][0][j],s[i][1][j]];W(sl1,nlv);nlv==nrv?C(sr,'display:none'):(C(sr,'display:block'),W(sr,nrv),C(sr,F1+C1+G(i).replace('50%','75%')))})()));
const ng=H(i,75),nb=H(i,50);
a[0].style.borderImage=nb+' 1';a[0].style.background=ng;uc();mo&&J()
}));
[il,ir,sd].forEach(el=>aL(el,'click',e=>e.stopPropagation()));
[sl1,sr].forEach(el=>C(el,F1+C1+tc));
w.append(l3,sl1,sr,sd);pd.append(w)
});
a[2]=pd;a[0].append(pd);
const bt1=mk('div','',S2);
BT.forEach((em,k)=>{const b=mk('div',em,CU+F2+C1+'#29f;');b.onclick=[()=>(s.splice(i+1,0,cp(s[i])),At()),()=>(s.splice(i+1,0,rv()),At()),()=>(s.splice(i+1,0,sw(cp(s[i]))),At())][k];bt1.append(b)});
a[0].append(bt1);return a
},
uc=()=>E.forEach((el,i)=>{const [ng,nb]=[H(i,75),H(i,50)];el[0].style.borderImage=nb+' 1';el[0].style.background=ng;i>=s.length-1&&(el[0].style.borderColor=nb,el[0].style.borderImage='none')}),
At=()=>(E.length=0,sl.length=0,U[4].replaceChildren(),s.forEach((a,i)=>{const b=L(i);E[i]=b;U[4].append(b[0])}),z(),uc(),J()),
z=()=>W(U[5],`Configuration-${s.length}etapes-${s.reduce((b,c)=>b+c[0][0],0)}s`);
U=['body','h1','p','div','div','h2'].map(c);['','ðŸŒˆSpiraStrober','Generateur AudioStrobe G/D optimise','','Apercu',''].forEach((x,i)=>x&&W(U[i],x));U[0].style.paddingBottom='2dvw';[U[1],U[2],U[3],K(),U[4],U[5]].forEach(el=>U[0].append(el));e.append(U[0]);Array.from({length:4},()=>s.push(rv()));At()
</script>